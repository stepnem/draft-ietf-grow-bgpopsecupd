<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Updated BGP Operations and Security</title>
<meta content="Tobias Fiebig" name="author">
<meta content="
       
                The Border Gateway Protocol (BGP) is the protocol almost exclusively used in the Internet to exchange routing information between network domains.
                Due to this central nature, it is important to understand the security and reliability measures that can and should be deployed to prevent accidental or intentional routing disturbances.
       
       
                Previously, security considerations for BGP have been described in  .
                Since the publications of  , several developments and changes in operational practice took place that warrant an update of these best current practices.
       
       
                This document updates  , reiterating the best practices for BGP security from that document and adding new practices and recommendations that emerged since the publication of  .
                In the current version, this document covers practices to protect the BGP sessions itself such as Time to Live (TTL), the TCP Authentication Option (TCP-AO), and control-plane filtering.
                It also describes measures to better control the flow of routing information, using prefix filtering and automation of prefix filters, max-prefix filtering, Autonomous System(AS) path filtering, route flap dampening, and BGP community scrubbing.
       
       
                Newly added information and improvements include a unification of terminology, orienting it in  , changing recommendations regarding IXP LAN prefixes to align with operational practice, discussing ASPA and BGP roles, expanding on community scrubbing, filter generation and evaluation practices to limit performance overhead, expanding on outbound and internal filtering for defense in depth, global prefix limits, and community based filtering for downstream prefixes.
       
    " name="description">
<meta content="xml2rfc 3.18.1" name="generator">
<meta content="draft-fiebig-grow-bgpopsecupd-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.18.1
    Python 3.11.5
    ConfigArgParse 1.5.3
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.3
    platformdirs 3.11.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.31.0
    setuptools 67.7.2
    six 1.16.0
    wcwidth 0.2.8
-->
<link href="draft-fiebig-grow-bgpopsecupd.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">BGP OPSEC</td>
<td class="right">October 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Fiebig</td>
<td class="center">Expires 16 April 2024</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Operational Security Capabilities for IP Network Infrastructure</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-fiebig-grow-bgpopsecupd-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2023-10-14" class="published">14 October 2023</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Best Current Practice</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2024-04-16">16 April 2024</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">T. Fiebig</div>
<div class="org">MPI-INF</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Updated BGP Operations and Security</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
                The Border Gateway Protocol (BGP) is the protocol almost exclusively used in the Internet to exchange routing information between network domains.
                Due to this central nature, it is important to understand the security and reliability measures that can and should be deployed to prevent accidental or intentional routing disturbances.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">
                Previously, security considerations for BGP have been described in <span>[<a href="#RFC7454" class="cite xref">RFC7454</a>]</span>.
                Since the publications of <span>[<a href="#RFC7454" class="cite xref">RFC7454</a>]</span>, several developments and changes in operational practice took place that warrant an update of these best current practices.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">
                This document updates <span>[<a href="#RFC7454" class="cite xref">RFC7454</a>]</span>, reiterating the best practices for BGP security from that document and adding new practices and recommendations that emerged since the publication of <span>[<a href="#RFC7454" class="cite xref">RFC7454</a>]</span>.
                In the current version, this document covers practices to protect the BGP sessions itself such as Time to Live (TTL), the TCP Authentication Option (TCP-AO), and control-plane filtering.
                It also describes measures to better control the flow of routing information, using prefix filtering and automation of prefix filters, max-prefix filtering, Autonomous System(AS) path filtering, route flap dampening, and BGP community scrubbing.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
<p id="section-abstract-4">
                Newly added information and improvements include a unification of terminology, orienting it in <span>[<a href="#RFC9234" class="cite xref">RFC9234</a>]</span>, changing recommendations regarding IXP LAN prefixes to align with operational practice, discussing ASPA and BGP roles, expanding on community scrubbing, filter generation and evaluation practices to limit performance overhead, expanding on outbound and internal filtering for defense in depth, global prefix limits, and community based filtering for downstream prefixes.<a href="#section-abstract-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 16 April 2024.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-requirements-language" class="internal xref">Requirements Language</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-scope-of-the-document" class="internal xref">Scope of the Document</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-definitions-and-acronyms" class="internal xref">Definitions and Acronyms</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-protection-of-the-bgp-speak" class="internal xref">Protection of the BGP Speaker</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-bgp-network-layer-protectio" class="internal xref">BGP Network Layer Protection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-bgp-speaker-management-inte" class="internal xref">BGP Speaker Management Interface Protection</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-protection-of-the-bgp-sessi" class="internal xref">Protection of the BGP Sessions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-protection-of-tcp-sessions-" class="internal xref">Protection of TCP Sessions Used by BGP</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="auto internal xref">5.1.1</a>.  <a href="#name-integrity-verification-and-" class="internal xref">Integrity Verification and Authentication</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="auto internal xref">5.1.2</a>.  <a href="#name-defending-against-pmtud-rel" class="internal xref">Defending Against PMTUD Related Attacks</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-bgp-ttl-security-gtsm" class="internal xref">BGP TTL Security (GTSM)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-static-prefix-filtering" class="internal xref">Static Prefix Filtering</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-special-purpose-prefixes" class="internal xref">Special-Purpose Prefixes</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="auto internal xref">6.1.1</a>.  <a href="#name-ipv4-special-purpose-prefix" class="internal xref">IPv4 Special-Purpose Prefixes</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="auto internal xref">6.1.2</a>.  <a href="#name-ipv6-special-purpose-prefix" class="internal xref">IPv6 Special-Purpose Prefixes</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-unallocated-prefixes" class="internal xref">Unallocated Prefixes</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="auto internal xref">6.2.1</a>.  <a href="#name-iana-allocated-prefix-filte" class="internal xref">IANA-Allocated Prefix Filters</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-prefixes-that-are-too-unspe" class="internal xref">Prefixes That Are Too (Un)Specific</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-the-default-route" class="internal xref">The Default Route</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.1">
                    <p id="section-toc.1-1.6.2.4.2.1.1"><a href="#section-6.4.1" class="auto internal xref">6.4.1</a>.  <a href="#name-ipv4" class="internal xref">IPv4</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.2">
                    <p id="section-toc.1-1.6.2.4.2.2.1"><a href="#section-6.4.2" class="auto internal xref">6.4.2</a>.  <a href="#name-ipv6" class="internal xref">IPv6</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-dynamic-prefix-filtering" class="internal xref">Dynamic Prefix Filtering</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-prefix-filters-created-from" class="internal xref">Prefix Filters Created from Internet Routing Registries (IRRs)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.1">
                    <p id="section-toc.1-1.7.2.1.2.1.1"><a href="#section-7.1.1" class="auto internal xref">7.1.1</a>.  <a href="#name-route-objects" class="internal xref">Route Objects</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.2">
                    <p id="section-toc.1-1.7.2.1.2.2.1"><a href="#section-7.1.2" class="auto internal xref">7.1.2</a>.  <a href="#name-as-sets" class="internal xref">AS-SETs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.3">
                    <p id="section-toc.1-1.7.2.1.2.3.1"><a href="#section-7.1.3" class="auto internal xref">7.1.3</a>.  <a href="#name-recursively-computing-filte" class="internal xref">Recursively Computing Filters</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-sidr-secure-inter-domain-ro" class="internal xref">SIDR - Secure Inter-Domain Routing: RPKI and ASPA</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.1">
                    <p id="section-toc.1-1.7.2.2.2.1.1"><a href="#section-7.2.1" class="auto internal xref">7.2.1</a>.  <a href="#name-route-origin-validation-rov" class="internal xref">Route Origin Validation (ROV)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.2">
                    <p id="section-toc.1-1.7.2.2.2.2.1"><a href="#section-7.2.2" class="auto internal xref">7.2.2</a>.  <a href="#name-autonomous-system-provider-" class="internal xref">Autonomous System Provider Authorization (ASPA)</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-inbound-filtering-prefixes-" class="internal xref">Inbound Filtering Prefixes Belonging to the Local AS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-inbound-filtering-prefixes-b" class="internal xref">Inbound Filtering Prefixes Belonging to Downstreams</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="auto internal xref">7.5</a>.  <a href="#name-outbound-filtering-prefixes" class="internal xref">Outbound Filtering Prefixes Based on Learned-From</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5.2.1">
                    <p id="section-toc.1-1.7.2.5.2.1.1"><a href="#section-7.5.1" class="auto internal xref">7.5.1</a>.  <a href="#name-outbound-filtering-prefixes-" class="internal xref">Outbound Filtering Prefixes Using BGP Roles</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5.2.2">
                    <p id="section-toc.1-1.7.2.5.2.2.1"><a href="#section-7.5.2" class="auto internal xref">7.5.2</a>.  <a href="#name-outbound-filtering-using-la" class="internal xref">Outbound Filtering Using Large-Communities</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="auto internal xref">7.6</a>.  <a href="#name-ixp-lan-prefixes" class="internal xref">IXP LAN Prefixes</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6.2.1">
                    <p id="section-toc.1-1.7.2.6.2.1.1"><a href="#section-7.6.1" class="auto internal xref">7.6.1</a>.  <a href="#name-ixp-lan-prefix-filtering" class="internal xref">IXP LAN Prefix Filtering</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6.2.2">
                    <p id="section-toc.1-1.7.2.6.2.2.1"><a href="#section-7.6.2" class="auto internal xref">7.6.2</a>.  <a href="#name-prefixes-on-routers-connect" class="internal xref">Prefixes on Routers Connected to an IXP</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6.2.3">
                    <p id="section-toc.1-1.7.2.6.2.3.1"><a href="#section-7.6.3" class="auto internal xref">7.6.3</a>.  <a href="#name-pmtud-and-the-loose-urpf-pr" class="internal xref">PMTUD and the Loose uRPF Problem</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-filtering-and-cleaning-base" class="internal xref">Filtering and Cleaning Based on Other BGP Aspects</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-bgp-route-flap-dampening" class="internal xref">BGP Route Flap Dampening</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-maximum-prefixes" class="internal xref">Maximum Prefixes</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.1">
                    <p id="section-toc.1-1.8.2.2.2.1.1"><a href="#section-8.2.1" class="auto internal xref">8.2.1</a>.  <a href="#name-maximum-prefixes-on-a-singl" class="internal xref">Maximum Prefixes on a Single Session</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.2">
                    <p id="section-toc.1-1.8.2.2.2.2.1"><a href="#section-8.2.2" class="auto internal xref">8.2.2</a>.  <a href="#name-maximum-prefixes-per-neighb" class="internal xref">Maximum Prefixes per Neighboring AS</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-as-path-filtering" class="internal xref">AS Path Filtering</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-next-hop-filtering" class="internal xref">Next-Hop Filtering</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="auto internal xref">8.5</a>.  <a href="#name-bgp-community-scrubbing" class="internal xref">BGP Community Scrubbing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.6">
                <p id="section-toc.1-1.8.2.6.1"><a href="#section-8.6" class="auto internal xref">8.6</a>.  <a href="#name-bgp-attribute-scrubbing" class="internal xref">BGP Attribute Scrubbing</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-prefix-filtering-recommenda" class="internal xref">Prefix Filtering Recommendations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-prefix-filter-implementatio" class="internal xref">Prefix Filter Implementation Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.1">
                    <p id="section-toc.1-1.9.2.1.2.1.1"><a href="#section-9.1.1" class="auto internal xref">9.1.1</a>.  <a href="#name-order-of-prefixfilters" class="internal xref">Order of Prefixfilters</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.2">
                    <p id="section-toc.1-1.9.2.1.2.2.1"><a href="#section-9.1.2" class="auto internal xref">9.1.2</a>.  <a href="#name-ensuring-consistency-when-c" class="internal xref">Ensuring Consistency when Changing Prefixfilters</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.3">
                    <p id="section-toc.1-1.9.2.1.2.3.1"><a href="#section-9.1.3" class="auto internal xref">9.1.3</a>.  <a href="#name-ruleset-size-considerations" class="internal xref">Ruleset Size Considerations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.4">
                    <p id="section-toc.1-1.9.2.1.2.4.1"><a href="#section-9.1.4" class="auto internal xref">9.1.4</a>.  <a href="#name-ruleset-generation-failure" class="internal xref">Ruleset Generation Failure</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-prefix-filtering-recommendat" class="internal xref">Prefix Filtering Recommendations in Full Routing Networks</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.1">
                    <p id="section-toc.1-1.9.2.2.2.1.1"><a href="#section-9.2.1" class="auto internal xref">9.2.1</a>.  <a href="#name-filters-with-internet-peers" class="internal xref">Filters with Internet Peers</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.2">
                    <p id="section-toc.1-1.9.2.2.2.2.1"><a href="#section-9.2.2" class="auto internal xref">9.2.2</a>.  <a href="#name-filters-with-customers" class="internal xref">Filters with Customers</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.3">
                    <p id="section-toc.1-1.9.2.2.2.3.1"><a href="#section-9.2.3" class="auto internal xref">9.2.3</a>.  <a href="#name-filters-with-upstream-provi" class="internal xref">Filters with Upstream Providers</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-prefix-filtering-recommendati" class="internal xref">Prefix Filtering Recommendations for Leaf Networks</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.1">
                    <p id="section-toc.1-1.9.2.3.2.1.1"><a href="#section-9.3.1" class="auto internal xref">9.3.1</a>.  <a href="#name-inbound-filtering-4" class="internal xref">Inbound Filtering</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.2">
                    <p id="section-toc.1-1.9.2.3.2.2.1"><a href="#section-9.3.2" class="auto internal xref">9.3.2</a>.  <a href="#name-outbound-filtering-4" class="internal xref">Outbound Filtering</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-9.4" class="auto internal xref">9.4</a>.  <a href="#name-prefix-filtering-recommendatio" class="internal xref">Prefix Filtering Recommendations for Mutual Transit</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a href="#section-9.5" class="auto internal xref">9.5</a>.  <a href="#name-prefix-filtering-recommendation" class="internal xref">Prefix Filtering Recommendations for iBGP</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="sec-introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">
                The Border Gateway Protocol (BGP), specified in <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span>, is the protocol used in the Internet to exchange routing information between network domains.
                BGP does not directly include mechanisms that control whether the routes exchanged conform to the various guidelines defined by the Internet community.
                This document intends to both summarize common existing guidelines and help operators apply coherent BGP policies.<a href="#section-1-1" class="pilcrow">¶</a></p>
<section id="section-1.1">
        <h3 id="name-requirements-language">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
                  "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT
                  RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be
                  interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span>
          <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in
                  all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="sec-scope-of-the-document">
<section id="section-2">
      <h2 id="name-scope-of-the-document">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-scope-of-the-document" class="section-name selfRef">Scope of the Document</a>
      </h2>
<p id="section-2-1">
                The guidelines defined in this document are intended for BGP sessions carrying generic Internet routing information within the DFZ.
                The nature of the Internet is such that Autonomous Systems can always agree on exceptions to a common framework for relevant local needs, and therefore configure a BGP session in a manner that may differ from the recommendations provided in this document.
                While this is perfectly acceptable, every configured exception might have an impact on the entire inter-domain routing environment, and operators <span class="bcp14">SHOULD</span> carefully appraise this impact before implementation.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-definitions-and-acronyms">
<section id="section-3">
      <h2 id="name-definitions-and-acronyms">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-definitions-and-acronyms" class="section-name selfRef">Definitions and Acronyms</a>
      </h2>
<p id="section-3-1">
                The following terms are used in this document:<a href="#section-3-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3-2">
        <dt id="section-3-2.1">ACL:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.2">Access Control List<a href="#section-3-2.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.3">ASN:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.4">Autonomous System Number<a href="#section-3-2.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.5">DFZ:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.6">Default Free Zone<a href="#section-3-2.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.7">GRT:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.8">Global Routing Table<a href="#section-3-2.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.9">IRR:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.10">Internet Routing Registry<a href="#section-3-2.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.11">IXP:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.12">Internet Exchange Point<a href="#section-3-2.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.13">LIR:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.14">Local Internet Registry<a href="#section-3-2.14" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.15">NLRI:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.16">Network Layer Reachability Information<a href="#section-3-2.16" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.17">OTC:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.18">Only To Customer BGP Attribute<a href="#section-3-2.18" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.19">PMTUD:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.20">Path MTU Discovery<a href="#section-3-2.20" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.21">uRPF:</dt>
        <dd style="margin-left: 1.5em" id="section-3-2.22">Unicast Reverse Path Forwarding<a href="#section-3-2.22" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-3-3">
                In addition to the list above, the following terms are used with a specific meaning.<a href="#section-3-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3-4">
        <dt id="section-3-4.1">BGP Speaker:</dt>
        <dd style="margin-left: 1.5em" id="section-3-4.2">A device exchanging routes with other BGP speakers using the BGP protocol<a href="#section-3-4.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-4.3">BGP Neighbor:</dt>
        <dd style="margin-left: 1.5em" id="section-3-4.4">Also just 'Neighbor'. Two BGP speakers that communicate using the BGP protocols are neighbors.<a href="#section-3-4.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-4.5">Cone:</dt>
        <dd style="margin-left: 1.5em" id="section-3-4.6">The set of ASes who are either direct downstreams of an AS, or in the cone of any of those ASes; Depending on the context this also includes the joint set of prefixes that may be originated by ASes in a cone.<a href="#section-3-4.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-4.7">Downstream:</dt>
        <dd style="margin-left: 1.5em" id="section-3-4.8">In a direct relationship between two ASes the one receiving upstream from the other. (See: <span>[<a href="#RFC9234" class="cite xref">RFC9234</a>]</span>, also known as the customer in a customer-provider relationship.)<a href="#section-3-4.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-4.9">Exporting a Prefix:</dt>
        <dd style="margin-left: 1.5em" id="section-3-4.10">Advertising a prefix to a neighbor.<a href="#section-3-4.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-4.11">Full Table:</dt>
        <dd style="margin-left: 1.5em" id="section-3-4.12">A routing table containing a route to all prefixes in the GRT but not the default route.<a href="#section-3-4.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-4.13">Importing a Prefix:</dt>
        <dd style="margin-left: 1.5em" id="section-3-4.14">Accepting a prefix advertised by a neighbor and considering it for route selection and import into the local AS' routing table.<a href="#section-3-4.14" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-4.15">Network edge:</dt>
        <dd style="margin-left: 1.5em" id="section-3-4.16">Last routers under the control of an operator.<a href="#section-3-4.16" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-4.17">Mutual Upstream:</dt>
        <dd style="margin-left: 1.5em" id="section-3-4.18">When two directly connected ASes both advertise a BGP fulltable to each other. (See: <span>[<a href="#I-D.ietf-sidrops-aspa-verification" class="cite xref">I-D.ietf-sidrops-aspa-verification</a>]</span>)<a href="#section-3-4.18" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-4.19">Upstream:</dt>
        <dd style="margin-left: 1.5em" id="section-3-4.20">In a direct relationship between two ASes the one providing upstream to the other. (See: <span>[<a href="#RFC9234" class="cite xref">RFC9234</a>]</span>, also known as the provider in a customer-provider relationship.)<a href="#section-3-4.20" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-4.21">Operator:</dt>
        <dd style="margin-left: 1.5em" id="section-3-4.22">Individual, group of people, or organizational unit responsible for operating BGP speakers, i.e., making administrative changes, as well as defining and setting policies for all BGP speakers within an organization.<a href="#section-3-4.22" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-4.23">Originating a Prefix:</dt>
        <dd style="margin-left: 1.5em" id="section-3-4.24">Advertising a prefix with an empty AS-Path.<a href="#section-3-4.24" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-4.25">Peer:</dt>
        <dd style="margin-left: 1.5em" id="section-3-4.26">Two directly connected ASes who only advertise routes they originate or learned from their downstreams to each other. (See: <span>[<a href="#RFC9234" class="cite xref">RFC9234</a>]</span>)<a href="#section-3-4.26" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-4.27">Providing Transit:</dt>
        <dd style="margin-left: 1.5em" id="section-3-4.28">Forwarding packets destined for addresses in an advertised prefix.<a href="#section-3-4.28" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-4.29">Providing Upstream:</dt>
        <dd style="margin-left: 1.5em" id="section-3-4.30">Providing transit while advertising a full BGP table or default route to the neighbor.<a href="#section-3-4.30" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-4.31">Router:</dt>
        <dd style="margin-left: 1.5em" id="section-3-4.32">In this document, router always refers to a BGP speaker.<a href="#section-3-4.32" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-protection-of-the-bgp-speaker">
<section id="section-4">
      <h2 id="name-protection-of-the-bgp-speak">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-protection-of-the-bgp-speak" class="section-name selfRef">Protection of the BGP Speaker</a>
      </h2>
<p id="section-4-1">
                The BGP speaker needs to be protected from external attempts to subvert the BGP session.
                Furthermore, access to management services of the BGP speaker should be limited to neighbors, as these services usually share resources with the control plane and, e.g., automated attacks on management ports may impact the BGP speaker's ability to execute BGP related tasks.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="sec-protection-of-the-bgp-speaker-net">
<section id="section-4.1">
        <h3 id="name-bgp-network-layer-protectio">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-bgp-network-layer-protectio" class="section-name selfRef">BGP Network Layer Protection</a>
        </h3>
<p id="section-4.1-1">
                    To protect a BGP speaker on the network layer, the ability to connect to TCP port 179 on the local device should be restricted to known addresses that are permitted to become a BGP neighbor.
                    Experience has shown that the natural protection TCP should offer is not always sufficient, as it is sometimes run in control-plane software.
                    In the absence of ACLs, it is possible to attack a BGP speaker by simply sending a high volume of connection requests to it.
                    This protection <span class="bcp14">SHOULD</span> be implemented by using an Access Control List (ACL) to limit access to TCP port 179 to authorized hosts.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">
                    If supported, an ACL specific to the control plane of the router <span class="bcp14">SHOULD</span> be used (receive-ACL, control-plane policing, etc.), to avoid configuration of data-plane filters for packets transiting through the router (and therefore not reaching the control plane).
                    If the hardware cannot do that, interface ACLs can be used to block packets addressed to the local router.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">
                    Some routers automatically program such an ACL upon BGP configuration.
                    On other devices, this ACL should be configured and maintained manually or using scripts.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">
                    In addition to strict filtering, rate-limiting MAY be configured for accepted BGP traffic.
                    Rate-limiting BGP traffic consists in permitting only a certain quantity of bits per second (or packets per second) of BGP traffic to the control plane.
                    This protects the BGP router control plane in case the amount of BGP traffic surpasses platform capabilities.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">
                    Furthermore, it is possible to use non-gloablly reachable addresses for BGP session links.
                    Options include using IPv4 routes with an IPv6 next hop in IPv4 sessions (see <span>[<a href="#RFC9229" class="cite xref">RFC9229</a>]</span>), using prefixes not advertised in the GRT (<span>[<a href="#TBD" class="cite xref">TBD</a>]</span>), using unnumbered BGP/Link-Local addresses (also using <span>[<a href="#RFC9229" class="cite xref">RFC9229</a>]</span>), or using <span>[<a href="#RFC1918" class="cite xref">RFC1918</a>]</span> addresses for IPv4 sessions.
                    Even though routing based network layer protection <span class="bcp14">MAY</span> be implemented, it <span class="bcp14">SHOULD</span> only be done in addition to deploying ACLs.
                    If any of these approaches is utilized, it <span class="bcp14">MUST</span> be ensured that the BGP speaker originates Path MTU Discovery related packets (see <span>[<a href="#RFC1191" class="cite xref">RFC1191</a>]</span> for IPv4 and <span>[<a href="#RFC8201" class="cite xref">RFC8201</a>]</span> for IPv6) from a globally reachable address, to ensure that Reverse Path Filtering of external parties does not interfere with PMTUD discovery for transiting traffic.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-protection-of-the-bgp-speaker-mgmt">
<section id="section-4.2">
        <h3 id="name-bgp-speaker-management-inte">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-bgp-speaker-management-inte" class="section-name selfRef">BGP Speaker Management Interface Protection</a>
        </h3>
<p id="section-4.2-1">
                    Usually, a BGP speaker's management interface is also reachable via the default routing domain / VRF (Virtual Routing Fabric) of the control plane.
                    Hence, if an operator or an attacker brings down a router by overloading one of the other protocols remotely, BGP is harmed as well.
                    To make it easier to separate BGP and management related control plane traffic, management traffic <span class="bcp14">SHOULD</span> be handled via a dedicated routing domain / VRF.
                    This routing domain / VRF should be protected from unauthorized connections by ACLs not handled on the BGP speaker itself to ensure that the control plane cannot be overloaded by attacks on the management interfaces of the BGP speaker.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">
                    In general, filtering and rate-limiting of control-plane traffic is a wider topic than "just for BGP".
                    For further recommendations on how to protect the router's control plane, see <span>[<a href="#RFC6192" class="cite xref">RFC6192</a>]</span> )<a href="#section-4.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-protection-of-the-bgp-sessions">
<section id="section-5">
      <h2 id="name-protection-of-the-bgp-sessi">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-protection-of-the-bgp-sessi" class="section-name selfRef">Protection of the BGP Sessions</a>
      </h2>
<p id="section-5-1">
                Current security issues of TCP-based protocols (therefore including BGP) have been documented in <span>[<a href="#RFC6952" class="cite xref">RFC6952</a>]</span>.
                The following subsections list the major points raised in this document and give the best practices related to TCP session protection for BGP operation.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="sec-protection-of-tcp-sessions-used-by-bgp">
<section id="section-5.1">
        <h3 id="name-protection-of-tcp-sessions-">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-protection-of-tcp-sessions-" class="section-name selfRef">Protection of TCP Sessions Used by BGP</a>
        </h3>
<p id="section-5.1-1">
                    Attacks on TCP sessions used by BGP (aka BGP sessions), for example, sending spoofed TCP RST packets, could bring down a BGP session.
                    Following a successful ARP spoofing attack (or other similar man-in- the-middle attack), the attacker might even be able to inject packets into the TCP stream (routing attacks).<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">
                    BGP sessions can be secured with a variety of mechanisms.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<div id="sec-protection-of-tcp-sessions-used-by-bgp-integrity">
<section id="section-5.1.1">
          <h4 id="name-integrity-verification-and-">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-integrity-verification-and-" class="section-name selfRef">Integrity Verification and Authentication</a>
          </h4>
<p id="section-5.1.1-1">
                        MD5 protection of the TCP session header, described in <span>[<a href="#RFC5925" class="cite xref">RFC5925</a>]</span>, was the first available mechanism to protect the integrity of a BGP session.
                        It has been obsoleted by the TCP Authentication Option (TCP-AO; <span>[<a href="#RFC5925" class="cite xref">RFC5925</a>]</span>), which offers stronger protection.
                        While MD5 is still the most used mechanism due to its availability in vendors' equipment, TCP-AO <span class="bcp14">SHOULD</span> be preferred when implemented by both sides of a session.<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1.1-2">
                        IPsec could also be used for session protection.
                        At the time of publication, there has been no wide-spread adoption of using IPsec for BGP sessions, and further analysis is required to define guidelines.<a href="#section-5.1.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1.1-3">
                        The drawback of TCP session protection is additional configuration and management overhead for the maintenance of authentication information (for example, MD5 passwords).
                        Protection of TCP sessions used by BGP hence <span class="bcp14">MAY</span> be enabled even when BGP sessions are established over shared networks where spoofing can be done (like IXPs), but operators are <span class="bcp14">RECOMMENDED</span> to consider the trade-offs and to apply TCP session protection where appropriate.<a href="#section-5.1.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1.1-4">
                        Furthermore, operators <span class="bcp14">SHOULD</span> block spoofed packets (packets with a source IP address not belonging to their IP address space) at all edges of their network (see <span>[<a href="#RFC2827" class="cite xref">RFC2827</a>]</span>  and <span>[<a href="#RFC3704" class="cite xref">RFC3704</a>]</span> ).
                        This protects the TCP session used by Internal BGP (iBGP) from attackers outside the Autonomous System.
                        Similarly, the considerations for using non globally reachable addresses for links handling BGP sessions from <a href="#sec-protection-of-the-bgp-speaker-net" class="auto internal xref">Section 4.1</a> apply accordingly.<a href="#section-5.1.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-protection-of-tcp-sessions-used-by-bgp-pmtud">
<section id="section-5.1.2">
          <h4 id="name-defending-against-pmtud-rel">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-defending-against-pmtud-rel" class="section-name selfRef">Defending Against PMTUD Related Attacks</a>
          </h4>
<p id="section-5.1.2-1">
                        In 2018 an attack on BGP was described in the literature which claims to enable BGP route injection without Layer 2 adjacency by leveraging PMTUD, see (<span>[<a href="#FENG-22" class="cite xref">FENG-22</a>]</span>).
                        The attack leverages packet fragmentation to bypass standard TCP protection mechanisms, so routes can be injected into an established BGP session.
                        While the attack would be mitigated by the integrity mechanisms suggested in <a href="#sec-protection-of-tcp-sessions-used-by-bgp-integrity" class="auto internal xref">Section 5.1.1</a>, operators <span class="bcp14">SHOULD</span> additionally take precautions to defend against these attacks, especially if authentication mechanisms are not in use.
                        To mitigate this attack, BGP speakers should not allow packet fragmentation on the control plane for BGP traffic between themselves and their neighbors.
                        This is feasible, as even on multi-hop sessions, the path MTU should be known to the operators, meaning that it can be statically and consistently configured for both speakers involved in a session to prevent the need for fragmentation.
                        Hence, operators <span class="bcp14">SHOULD</span> ensure that fragmentation is neither allowed nor necessary for BGP packets between two BGP speakers.
                        If this is not possible, a strict lower limit for the MTU <span class="bcp14">SHOULD</span> be configured.
                        Given that IPv6 requires an MTU of at least 1280b, this value is the <span class="bcp14">RECOMMENDED</span> minimum.<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-bgp-ttl-security-gtsm">
<section id="section-5.2">
        <h3 id="name-bgp-ttl-security-gtsm">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-bgp-ttl-security-gtsm" class="section-name selfRef">BGP TTL Security (GTSM)</a>
        </h3>
<p id="section-5.2-1">
                    BGP sessions can be made harder to spoof with the Generalized TTL Security Mechanisms (GTSM aka TTL security), defined in <span>[<a href="#RFC5082" class="cite xref">RFC5082</a>]</span>.
                    Instead of sending TCP packets with TTL value of 1, the BGP speakers send the TCP packets with TTL value of 255, and the receiver checks that the TTL value equals 255.
                    Since it's impossible to send an IP packet with TTL of 255 to an IP host that is not directly connected, BGP TTL security effectively prevents all spoofing attacks coming from third parties not directly connected to the same subnet as the BGP-speaking routers.
                    Operators <span class="bcp14">SHOULD</span> implement TTL security on directly connected BGP neighbors.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">
                    GTSM could also be applied to multi-hop BGP session as well.
                    To achieve this, TTL needs to be configured with a proper value depending on the distance between BGP speakers (using the principle described above).
                    Nevertheless, it is not as effective because anyone inside the TTL diameter could spoof the TTL.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">
                    Like MD5 protection, TTL security has to be configured on both ends of a BGP session.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-static-prefix-filtering">
<section id="section-6">
      <h2 id="name-static-prefix-filtering">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-static-prefix-filtering" class="section-name selfRef">Static Prefix Filtering</a>
      </h2>
<p id="section-6-1">
                The main aspect of securing BGP resides in controlling the prefixes that are received and advertised on the BGP session.
                Prefixes exchanged between BGP neighbors are controlled with inbound and outbound filters that can match on well-known/statically typed IP prefixes (as described in this section), a combination of Prefix and AS paths (see ), BGP roles as (see <a href="#sec-filtering-outbound-prefixes-roles" class="auto internal xref">Section 7.5.1</a>), or any other attributes of a BGP prefix (for example, BGP communities, as described in <a href="#sec-filtering-outbound-prefixes-communities" class="auto internal xref">Section 7.5.2</a>).<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">
                This section lists the most commonly used static prefix filters.
                We define static prefixes as prefixes that are published via an authoritative list which changes, on average, not more frequently than every 12 months.
                We will utilize these definitions of static prefixes in <a href="#sec-prefix-filtering-rec" class="auto internal xref">Section 9</a> to clarify where and how these filters should be applied.<a href="#section-6-2" class="pilcrow">¶</a></p>
<div id="sec-special-purpose-prefixes">
<section id="section-6.1">
        <h3 id="name-special-purpose-prefixes">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-special-purpose-prefixes" class="section-name selfRef">Special-Purpose Prefixes</a>
        </h3>
<div id="sec-ipv4-special-purpose-prefixes">
<section id="section-6.1.1">
          <h4 id="name-ipv4-special-purpose-prefix">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-ipv4-special-purpose-prefix" class="section-name selfRef">IPv4 Special-Purpose Prefixes</a>
          </h4>
<p id="section-6.1.1-1">
                        The IANA IPv4 Special-Purpose Address Registry <span>[<a href="#IANAv4Spec" class="cite xref">IANAv4Spec</a>]</span>  maintains the list of IPv4 special-purpose prefixes and their routing scope, and it <span class="bcp14">SHOULD</span> be used for prefix-filter configuration.
                        Prefixes with value "False" in column "Global" <span class="bcp14">SHOULD</span> be discarded on Internet BGP sessions (eBGP).<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-ipv6-special-purpose-prefixes">
<section id="section-6.1.2">
          <h4 id="name-ipv6-special-purpose-prefix">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-ipv6-special-purpose-prefix" class="section-name selfRef">IPv6 Special-Purpose Prefixes</a>
          </h4>
<p id="section-6.1.2-1">
                        The IANA IPv6 Special-Purpose Address Registry <span>[<a href="#IANAv6Spec" class="cite xref">IANAv6Spec</a>]</span>  maintains the list of IPv6 special-purpose prefixes and their routing scope, and it <span class="bcp14">SHOULD</span> be used for prefix-filter configuration.
                        Only prefixes with value "False" in column "Global" <span class="bcp14">SHOULD</span> be discarded on Internet BGP sessions.<a href="#section-6.1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-static-unallocated-prefixes">
<section id="section-6.2">
        <h3 id="name-unallocated-prefixes">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-unallocated-prefixes" class="section-name selfRef">Unallocated Prefixes</a>
        </h3>
<p id="section-6.2-1">
                    IANA allocates prefixes to RIRs that in turn allocate prefixes to LIRs (Local Internet Registries).
                    While it is in general sensible to not accept routing table prefixes that are not allocated by IANA and/or RIRs, it is important to understand that filtering unallocated prefixes requires constant updates, as prefixes are continually allocated.
                    Therefore, automation of such prefix filters is key for the success of this approach.
                    Operators <span class="bcp14">SHOULD NOT</span> consider solutions described in this section if they are not capable of maintaining updated prefix filters: the damage would probably be worse than the intended security policy.
                    In this section we focus on IP address space allocated to RIRs by IANA.
                    Allocations by RIRs are generally more dynamic.
                    Therefore, we will discuss using RIR level data in <a href="#sec-rir-allocated-prefix-filters" class="auto internal xref">Section 7.1</a>.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<div id="sec-iana-allocated-prefix-filters">
<section id="section-6.2.1">
          <h4 id="name-iana-allocated-prefix-filte">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-iana-allocated-prefix-filte" class="section-name selfRef">IANA-Allocated Prefix Filters</a>
          </h4>
<p id="section-6.2.1-1">
                        IANA has allocated all the IPv4 available space.
                        Therefore, there is no reason why operators would keep checking that prefixes they receive from BGP neighbors are in the IANA-allocated IPv4 address space <span>[<a href="#IANAv4Reg" class="cite xref">IANAv4Reg</a>]</span>.
                        No specific filters need to be put in place by operators who want to make sure that IPv4 prefixes they receive in BGP updates have been allocated by IANA.<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<p id="section-6.2.1-2">
                        For IPv6, given the size of the address space, it can be seen as wise to accept only prefixes derived from those allocated by IANA.
                        Operators can dynamically build this list from the IANA- allocated IPv6 space <span>[<a href="#IANAv6Reg" class="cite xref">IANAv6Reg</a>]</span>.
                        As IANA keeps allocating prefixes to RIRs, the aforementioned list should be checked regularly against changes, and if they occur, prefix filters should be computed and pushed on network devices.
                        The list could also be pulled directly by routers when they implement such mechanisms.
                        As there is delay between the time an RIR receives a new prefix and the moment it starts allocating portions of it to its LIRs, there is no need for doing this step quickly and frequently.
                        However, operators <span class="bcp14">SHOULD</span> ensure that all IPv6 prefix filters are updated within a maximum of one month after any change in the list of IPv6 prefixes allocated by IANA.<a href="#section-6.2.1-2" class="pilcrow">¶</a></p>
<p id="section-6.2.1-3">
                        If the process in place (whether manual or automatic) cannot guarantee that the list is updated regularly, then it's better not to configure any filters based on allocated networks.
                        The IPv4 experience has shown that many network operators implemented filters for prefixes not allocated by IANA but did not update them on a regular basis.
                        This created problems for the latest allocations, and required extra work for RIRs that had to "de-bogonize" the newly allocated prefixes.
                        (See <span>[<a href="#RIPE-351" class="cite xref">RIPE-351</a>]</span>  for information on de-bogonizing.)<a href="#section-6.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-prefixes-that-are-too-specific">
<section id="section-6.3">
        <h3 id="name-prefixes-that-are-too-unspe">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-prefixes-that-are-too-unspe" class="section-name selfRef">Prefixes That Are Too (Un)Specific</a>
        </h3>
<p id="section-6.3-1">
                    Most ISPs will not accept advertisements beyond a certain level of specificity (and in return, they do not announce prefixes they consider to be too specific).
                    That acceptable specificity is decided for each session between two BGP neighbors.
                    Some ISP communities have tried to document acceptable specificity.
                    This document does not make any judgement on what the best approach is, it just notes that there are existing practices on the Internet and recommends that the reader refer to them.
                    As an example, the RIPE community has documented that, at the time of writing of this document, IPv4 prefixes longer than /24 and IPv6 prefixes longer than /48 are generally neither announced nor accepted in the Internet <span>[<a href="#RIPE-399" class="cite xref">RIPE-399</a>]</span>  <span>[<a href="#RIPE-532" class="cite xref">RIPE-532</a>]</span>.
                    These values may change in the future.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">
                    Some operators <span class="bcp14">MAY</span> choose to allow customers to additionally announce more specifics than commonly used on the Internet (see <a href="#sec-prefixes-that-are-too-specific" class="auto internal xref">Section 6.3</a>).
                    This can be to allow customers more fine-grained traffic steering in case of multiple BGP sessions between the AS and its customer in multiple locations, and/or to sub-delegate IPv4 address space smaller than a /24 from the AS' allocation to the customer.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3-3">
                    In that case, the operators <span class="bcp14">SHOULD</span> add a specific accept rule for these exact prefixes before Rule 11.
                    Routes of this type <span class="bcp14">SHOULD</span> be annotated in away that ensures they are not re-exported to other neighbors (see <a href="#sec-filtering-outbound-prefixes-communities" class="auto internal xref">Section 7.5.2</a>).
                    Furthermore, in case of using more specifics for traffic steering, the customer <span class="bcp14">SHOULD</span> also announce at least the covering /24 to ensure global reachability of the prefix and prevent issues with uRPF (see also <span>[<a href="#RFC8704" class="cite xref">RFC8704</a>]</span> and <a href="#sec-pmtud-and-the-loose-urpf-problem" class="auto internal xref">Section 7.6.3</a>).<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<p id="section-6.3-4">
                    Similar to too specific routes, most ISPs will not accept advertisements beyond a certain level of aggregation.
                    The general guideline here are the least specific allocations commonly handed out by RIRs to LIRs.
                    At the moment, the largest allocations for IPv4 are continuous /8.
                    For IPv6, one /13 allocation exists, followed by several LIRs holding /19.
                    Several operators currently limit the smallest prefix size for IPv6 to /16.
                    This document does not make any judgement on what the best approach is, it just notes that there are existing practices on the Internet and recommends that the reader refer to them.
                    These values may change in the future.<a href="#section-6.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-the-default-route">
<section id="section-6.4">
        <h3 id="name-the-default-route">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-the-default-route" class="section-name selfRef">The Default Route</a>
        </h3>
<div id="sec-ipv4">
<section id="section-6.4.1">
          <h4 id="name-ipv4">
<a href="#section-6.4.1" class="section-number selfRef">6.4.1. </a><a href="#name-ipv4" class="section-name selfRef">IPv4</a>
          </h4>
<p id="section-6.4.1-1">
                        Typically, the 0.0.0.0/0 prefix is not intended to be accepted or advertised except in specific customer/provider configurations; general filtering outside of these is <span class="bcp14">RECOMMENDED</span>.<a href="#section-6.4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-ipv6">
<section id="section-6.4.2">
          <h4 id="name-ipv6">
<a href="#section-6.4.2" class="section-number selfRef">6.4.2. </a><a href="#name-ipv6" class="section-name selfRef">IPv6</a>
          </h4>
<p id="section-6.4.2-1">
                        Typically, the ::/0 prefix is not intended to be accepted or advertised except in specific customer/provider configurations; general filtering outside of these is <span class="bcp14">RECOMMENDED</span>.<a href="#section-6.4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-prefix-filtering">
<section id="section-7">
      <h2 id="name-dynamic-prefix-filtering">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-dynamic-prefix-filtering" class="section-name selfRef">Dynamic Prefix Filtering</a>
      </h2>
<p id="section-7-1">
                In this section, we discuss dynamic prefix filters, i.e., filters that decide whether a prefix should be im- or exported or not based on frequently changing parameters and external resources.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="sec-rir-allocated-prefix-filters">
<section id="section-7.1">
        <h3 id="name-prefix-filters-created-from">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-prefix-filters-created-from" class="section-name selfRef">Prefix Filters Created from Internet Routing Registries (IRRs)</a>
        </h3>
<p id="section-7.1-1">
                    A more precise check can be performed when one would like to make sure that received prefixes are being originated or transited by Autonomous Systems (ASes) entitled to do so.
                    It has been observed in the past that an AS could easily advertise someone else's prefix (or more specific prefixes) and create black holes or security threats.
                    To partially mitigate this risk, administrators would need to make sure BGP advertisements correspond to information located in the existing registries.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">
                    An Internet Routing Registry (IRR) is a database containing Internet routing information, described using Routing Policy Specification Language objects as described in <span>[<a href="#RFC4012" class="cite xref">RFC4012</a>]</span>.
                    Operators are given privileges to describe routing policies of their own networks in the IRR, and that information is published, usually publicly.
                    A majority of Regional Internet Registries do also operate an IRR and can control whether registered routes conform to the prefixes that are allocated or directly assigned.
                    However, it should be noted that the list of such prefixes is not necessarily a complete list, and as such the list of routes in an IRR is not the same as the set of RIR-allocated prefixes.
                    Furthermore, especially IRRs not operated by RIRs regularly list conflicting information, see <a href="#sec-rir-allocated-prefix-filters" class="auto internal xref">Section 7.1</a>.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<div id="sec-prefix-filters-created-from-internet-routing-registries-irrs-routeobjects">
<section id="section-7.1.1">
          <h4 id="name-route-objects">
<a href="#section-7.1.1" class="section-number selfRef">7.1.1. </a><a href="#name-route-objects" class="section-name selfRef">Route Objects</a>
          </h4>
<p id="section-7.1.1-1">
                        The corner stone of IRR based information are ROUTE (IPv4) and ROUTE6 (IPv6) objects.
                        These document, for a given prefix, the AS/ASes allowed to originate the prefix.
                        Note that for a given prefix also more specific objects may exist.
                        However, technically, the semantic of a ROUTE/ROUTE6 object is that of an exact match.<a href="#section-7.1.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1.1-2">
                        Operators <span class="bcp14">SHOULD</span> create ROUTE/ROUTE6 objects for all prefixes they do or do plan to originate.<a href="#section-7.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-prefix-filters-created-from-internet-routing-registries-irrs-assets">
<section id="section-7.1.2">
          <h4 id="name-as-sets">
<a href="#section-7.1.2" class="section-number selfRef">7.1.2. </a><a href="#name-as-sets" class="section-name selfRef">AS-SETs</a>
          </h4>
<p id="section-7.1.2-1">
                        An AS-SET is an object that contains AS numbers or other AS-SETs.
                        The purpose of AS-SETs is creating a recursively queryable structure documenting the cone of an AS.
                        An operator may create an AS-SET defining all AS numbers of its customers.
                        A transit provider might create an AS-SET listing the AS numbers or AS-SETS of those ASes it provides upstream to. In turn, these ASes describe the AS numbers/AS-SETS of their customers, etc.
                        Using recursion, it is possible to retrieve from an AS-SET the complete list of AS numbers that the neighbor is likely to announce.
                        For each of these AS numbers, it is also easy to look in the corresponding IRR for all associated prefixes.<a href="#section-7.1.2-1" class="pilcrow">¶</a></p>
<p id="section-7.1.2-2">
                        Please note that different IRR may provide conflicting data, especially on AS-SETs.
                        Recently, an attack was observed where a malicious party created an empty AS-SET for a large transit provider (see <span>[<a href="#NLNOG-22" class="cite xref">NLNOG-22</a>]</span>).
                        As it was created in an RIR database often taking precedent over other IRR sources, several ASes imported this empty AS-SET, and hence filtered all prefixes advertised by this transit provider.
                        To mitigate this issue, hierarchical AS-SETs reside in the IRR of the RIR and explicitly list the ASN to which they pertain, e.g., AS65536:AS-EXAMPLE.
                        Additionally, the IRR source may also be referenced: RIPE::AS65536:AS-EXAMPLE.<a href="#section-7.1.2-2" class="pilcrow">¶</a></p>
<p id="section-7.1.2-3">
                        Operators <span class="bcp14">SHOULD</span> create a hierarchical AS-SET representing their cone.
                        If AS-SETs are included in another AS-SET, they <span class="bcp14">SHOULD</span> be hierarchical.<a href="#section-7.1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-prefix-filters-created-from-internet-routing-registries-irrs-creating-filters">
<section id="section-7.1.3">
          <h4 id="name-recursively-computing-filte">
<a href="#section-7.1.3" class="section-number selfRef">7.1.3. </a><a href="#name-recursively-computing-filte" class="section-name selfRef">Recursively Computing Filters</a>
          </h4>
<p id="section-7.1.3-1">
                        Using AS-SETs and ROUTE/ROUTE6 objects, it is possible to use the IRR information to build, for a given neighbor AS, a list of prefixes the neighbor is authorized to originated or transited.
                        This can be done relatively easily using scripts and existing tools capable of retrieving this information from the registries.
                        This approach is exactly the same for both IPv4 and IPv6.<a href="#section-7.1.3-1" class="pilcrow">¶</a></p>
<p id="section-7.1.3-2">
                        The macro-algorithm for the script is as follows.
                        For the neighbor that is considered, the distant operator has provided the AS and may be able to provide a hierarchically named AS-SET object (aka AS-MACRO).
                        With these two mechanisms, a script can build, for a given neighbor, that lists allowed prefixes and the AS number from which they should be originated.
                        One could decide not to use the origin information and only build monolithic prefix filters from fetched data combining prefixes a neighbor is authorized to transit and originate.<a href="#section-7.1.3-2" class="pilcrow">¶</a></p>
<p id="section-7.1.3-3">
                        As prefixes, AS numbers, and AS-SETs may not all be under the same RIR authority, it is difficult to choose for each object the appropriate IRR to poll.
                        Some IRRs have been created and are not restricted to a given region or authoritative RIR.
                        They allow RIRs to publish information contained in their IRR in a common place.
                        They also make it possible for any subscriber (probably under contract) to publish information too.
                        When doing requests inside such an IRR, it is possible to specify the source of information in order to have the most reliable data.
                        One could check a popular IRR containing many sources (such as RADb <span>[<a href="#RADb" class="cite xref">RADb</a>]</span>, the Routing Assets Database) and only select as sources some desired RIRs and trusted major ISPs (Internet Service Providers).<a href="#section-7.1.3-3" class="pilcrow">¶</a></p>
<p id="section-7.1.3-4">
                        As objects in IRRs may frequently vary over time, it is important that prefix filters computed using this mechanism are refreshed regularly.
                        Refreshing the filters on a daily basis <span class="bcp14">SHOULD</span> be considered because routing changes must sometimes be done in an emergency and registries may be updated at the very last moment.
                        Note that this approach significantly increases the complexity of the router configurations, as it can quickly add tens of thousands of configuration lines for some important neighbors, e.g., large peers or downstreams.
                        To manage this complexity, operators could use, for example, bgpq4 <span>[<a href="#bgpq4" class="cite xref">bgpq4</a>]</span>, a set of tools making it possible to simplify the creation of automated filter configuration from policies stored in an IRR.<a href="#section-7.1.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-sidr-secure-inter-domain-routing">
<section id="section-7.2">
        <h3 id="name-sidr-secure-inter-domain-ro">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-sidr-secure-inter-domain-ro" class="section-name selfRef">SIDR - Secure Inter-Domain Routing: RPKI and ASPA</a>
        </h3>
<p id="section-7.2-1">
                    SIDR (Secure Inter-Domain Routing), described in <span>[<a href="#RFC6480" class="cite xref">RFC6480</a>]</span>, has been designed to secure Internet advertisements.
                    Even though technically incorrect, as it is only the name of an important component, the use of techniques entailed in SIDR is commonly referred to as RPKI (Resource Public Key Infrastructure).<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">
                    There are basically two services that SIDR offers:<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-3.1">
                        Origin validation, described in <span>[<a href="#RFC6811" class="cite xref">RFC6811</a>]</span>, seeks to make sure that attributes associated with routes are correct, see <a href="#sec-sidr-rov" class="auto internal xref">Section 7.2.1</a>.
                        (The major point is the validation of the AS number originating a given route.)
                        Origin validation is now operational (Internet registries, protocols, implementations on some routers), and in theory it can be implemented knowing that the number of signed resources is still low at the time of writing this document.<a href="#section-7.2-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.2-3.2">
                        Path validation provided by BGPsec <span>[<a href="#RFC7353" class="cite xref">RFC7353</a>]</span>  seeks to make sure that no one announces fake/wrong BGP paths that would attract traffic for a given destination; see <span>[<a href="#RFC7132" class="cite xref">RFC7132</a>]</span>.
                        Even though the work on BGPsec has been concluded, adoption is still limited.
                        Instead, the use of ASPA (Autonomous System Provider Authorization) <span>[<a href="#I-D.ietf-sidrops-aspa-verification" class="cite xref">I-D.ietf-sidrops-aspa-verification</a>]</span> objects, see also <a href="#sec-sidr-aspa" class="auto internal xref">Section 7.2.2</a>, is likely to be more relevant within the context of BGP.
                        Even though the draft on ASPA has not been finalized, first adoption of ASPA can be observed, first implementations started to support it, following the development of <span>[<a href="#I-D.ietf-sidrops-aspa-verification" class="cite xref">I-D.ietf-sidrops-aspa-verification</a>]</span>, see <span>[<a href="#OpenBGPd" class="cite xref">OpenBGPd</a>]</span> and <span>[<a href="#rpki-client" class="cite xref">rpki-client</a>]</span>.<a href="#section-7.2-3.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.2-4">
                    Implementing SIDR mechanisms is expected to solve many of the BGP routing security problems in the long term, but it may take time for deployments to be made and objects to become signed.
                    Also, note that the SIDR infrastructure is complementing (not replacing) the security best practices listed in this document.
                    Therefore, operators <span class="bcp14">SHOULD</span> implement any SIDR proposed mechanism (for example, route origin validation) on top of the other existing mechanisms even if they could sometimes appear to be targeting the same goal.<a href="#section-7.2-4" class="pilcrow">¶</a></p>
<div id="sec-sidr-rov">
<section id="section-7.2.1">
          <h4 id="name-route-origin-validation-rov">
<a href="#section-7.2.1" class="section-number selfRef">7.2.1. </a><a href="#name-route-origin-validation-rov" class="section-name selfRef">Route Origin Validation (ROV)</a>
          </h4>
<p id="section-7.2.1-1">
                        If route origin validation is implemented, the reader <span class="bcp14">SHOULD</span> refer to the rules described in <span>[<a href="#RFC7115" class="cite xref">RFC7115</a>]</span>.
                        In short, each external route received on a router <span class="bcp14">SHOULD</span> be checked against the Resource Public Key Infrastructure (RPKI) data set:<a href="#section-7.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2.1-2.1">
                            If a corresponding ROA (Route Origin Authorization) is found and is valid, then the prefix <span class="bcp14">SHOULD</span> be accepted.<a href="#section-7.2.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.2.1-2.2">
                            If the ROA is found and is INVALID, then the prefix <span class="bcp14">SHOULD</span> be discarded.<a href="#section-7.2.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.2.1-2.3">
                            If a ROA is not found, then the prefix <span class="bcp14">SHOULD</span> be accepted, but the corresponding route <span class="bcp14">SHOULD</span> be given a low preference.<a href="#section-7.2.1-2.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-7.2.1-3">
                        In addition to this, operators <span class="bcp14">SHOULD</span> sign their routing objects so their routes can be validated by other networks running origin validation.
                        Please note that, when signing routing objects, operators <span class="bcp14">SHOULD</span> strive to create minimally covering ROAs for their intended announcements, see <span>[<a href="#RFC7115" class="cite xref">RFC7115</a>]</span> and <span>[<a href="#RFC9319" class="cite xref">RFC9319</a>]</span>, to reduce the attack surface of forged-origin hijacks and attempts to exhaust routers' route processing capacity in terms of memory and CPU <span>[<a href="#KIRIN-22" class="cite xref">KIRIN-22</a>]</span>.
                        For example, if an operator received a /29 allocation and intends to announce it in a deaggregation of /32, the corresponding ROA should cover the /29 with a longest allowed prefix of /32, instead of signing for a deaggregation up until /48.<a href="#section-7.2.1-3" class="pilcrow">¶</a></p>
<p id="section-7.2.1-4">
                        One should understand that the RPKI model brings new, interesting challenges.
                        The paper "On the Risk of Misbehaving RPKI Authorities" <span>[<a href="#hotRPKI" class="cite xref">hotRPKI</a>]</span> explains how the RPKI model can impact the Internet if authorities don't behave as they are supposed to.
                        Further analysis is certainly required on RPKI, which carries part of BGP security.<a href="#section-7.2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-sidr-aspa">
<section id="section-7.2.2">
          <h4 id="name-autonomous-system-provider-">
<a href="#section-7.2.2" class="section-number selfRef">7.2.2. </a><a href="#name-autonomous-system-provider-" class="section-name selfRef">Autonomous System Provider Authorization (ASPA)</a>
          </h4>
<p id="section-7.2.2-1">
                        If autonomous system provider authorization is implemented, the reader <span class="bcp14">SHOULD</span> refer to the rules described in <span>[<a href="#I-D.ietf-sidrops-aspa-verification" class="cite xref">I-D.ietf-sidrops-aspa-verification</a>]</span>.
                        In short, each external route received on a router <span class="bcp14">SHOULD</span> be checked against the ASPA record found in the Resource Public Key Infrastructure (RPKI) based on the relationship to the neighbor.<a href="#section-7.2.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2.2-2">
                        In <span>[<a href="#I-D.ietf-sidrops-aspa-verification" class="cite xref">I-D.ietf-sidrops-aspa-verification</a>]</span>, see following sections based on the neighbor relationship:<a href="#section-7.2.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2.2-3.1">
                            Section 6.1 for routes received from upstreams and lateral peers.<a href="#section-7.2.2-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.2.2-3.2">
                            Section 6.2 for routes received from downstreams and mutual-transits.<a href="#section-7.2.2-3.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-7.2.2-4">
                        ASPA validation can result in one of three outcomes, VALID, INVALID, and UNKNOWN.<a href="#section-7.2.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2.2-5.1">
                            If a route's AS_PATH is evaluated as VALID, then the prefix <span class="bcp14">SHOULD</span> be accepted.<a href="#section-7.2.2-5.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.2.2-5.2">
                            If a route's AS_PATH is evaluated as INVALID, then the prefix <span class="bcp14">SHOULD</span> be discarded, and the event logged.<a href="#section-7.2.2-5.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.2.2-5.3">
                            If a route's AS_PATH is evaluated as UNKNOWN, then the prefix <span class="bcp14">SHOULD</span> be accepted, and the event logged. The corresponding route <span class="bcp14">MAY</span> be given a low preference.<a href="#section-7.2.2-5.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="sec-filtering-prefixes-belonging-to-the-local-as">
<section id="section-7.3">
        <h3 id="name-inbound-filtering-prefixes-">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-inbound-filtering-prefixes-" class="section-name selfRef">Inbound Filtering Prefixes Belonging to the Local AS</a>
        </h3>
<p id="section-7.3-1">
                    A network <span class="bcp14">SHOULD</span> filter its own prefixes on BGP sessions with all its neighbors (inbound direction).
                    This prevents local traffic (from a local source to a local destination) from leaking over an external BGP session, in case someone else is announcing the prefix over the Internet.
                    This also protects the infrastructure that may directly suffer if the backbone's prefix is suddenly preferred over the Internet.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">
                    In some cases, for example, multihoming scenarios, such filters <span class="bcp14">SHOULD NOT</span> be applied, as this would break the desired redundancy.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-filtering-inbound-prefixes-belonging-to-ds">
<section id="section-7.4">
        <h3 id="name-inbound-filtering-prefixes-b">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-inbound-filtering-prefixes-b" class="section-name selfRef">Inbound Filtering Prefixes Belonging to Downstreams</a>
        </h3>
<p id="section-7.4-1">
                    Filtering prefixes belonging to multi-homed downstreams on sessions with other ASes is <span class="bcp14">NOT RECOMMENDED</span>.
                    This practice may lead to blackholing of traffic if the filter is semi-statically configured, i.e., not removed upon withdrawal of the specific prefix by a downstream.
                    Downstreams may choose to not advertise prefixes to an upstream for a variety of reasons, including traffic engineering and Denial-of-Service attack response.
                    Instead, operators <span class="bcp14">SHOULD</span> assign downstreams' prefixes learned from other neighbors a lower priority than those routes directly learned from downstreams.
                    This can be done, e.g., by adding additional path prepends or using local preference settings.
                    Please note, though, that using local preferences for this purpose may lead to a situation where a downstream is unable to perform traffic engineering apart from withdrawing a route towards its upstream in case of, e.g., a congested link in a multi-homed setup.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<p id="section-7.4-2">
                    Even though filtering prefixes belonging to single-homed downstreams on sessions with other ASes carries less risk of immediate negative impact, it is crucial that operators coordinate closely with their downstream if such practices are applied.
                    Otherwise, if a downstream becomes multi-homed connectivity issues may appear.
                    Hence, assuming that other appropriate filters are in place ensuring, e.g., validity of the announcing AS and the AS-PATH, see <a href="#sec-prefix-filtering-recommendations-in-full-routing-networks" class="auto internal xref">Section 9.2</a>, not filtering prefixes originated by downstreams on sessions with other ASes solely based on the prefix is <span class="bcp14">NOT RECOMMENDED</span>.<a href="#section-7.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-filtering-outbound-prefixes">
<section id="section-7.5">
        <h3 id="name-outbound-filtering-prefixes">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-outbound-filtering-prefixes" class="section-name selfRef">Outbound Filtering Prefixes Based on Learned-From</a>
        </h3>
<p id="section-7.5-1">
                    TODO: Make more general about annotating routes, also include BGP neighbor roles.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
<p id="section-7.5-2">
                    Prefixes learned from BGP neighbors may technically conform to static metrics and filter types discussed above.
                    For example, when learning prefixes from peers and/or upstreams which have been originally announced by downstreams of an AS, it is crucial to not leak these routes to upstreams and peers in case they are preferred over those learned directly from a downstream.
                    This may occur, for example, if a downstream uses path prepending with an upstream, while the upstream has a peering session with another AS which is also an upstream of said downstream.
                    With the route advertised by the peer being shorter, the AS may export the learned route via the peer if:<a href="#section-7.5-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.5-3.1">
                        The outbound filter only checks whether a prefix is in a prefix list.<a href="#section-7.5-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.5-3.2">
                        The outbound filter only checks whether a prefix is in a prefix list and has been originated by the downstream AS.<a href="#section-7.5-3.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.5-4">
                    To counteract this issue, outbound filtering should consider the source type, i.e., relationship to the neighbor from whom a route was originally learned.<a href="#section-7.5-4" class="pilcrow">¶</a></p>
<div id="sec-filtering-outbound-prefixes-roles">
<section id="section-7.5.1">
          <h4 id="name-outbound-filtering-prefixes-">
<a href="#section-7.5.1" class="section-number selfRef">7.5.1. </a><a href="#name-outbound-filtering-prefixes-" class="section-name selfRef">Outbound Filtering Prefixes Using BGP Roles</a>
          </h4>
<p id="section-7.5.1-1">
                        To ensure that no prefixes leak via AS relationships (routes learned from peers or upstreams to other peers or upstreams), <span>[<a href="#RFC9234" class="cite xref">RFC9234</a>]</span> introduces BGP roles and the BGP Only to Customer (OTC) attribute.
                        Operators <span class="bcp14">SHOULD</span> configure appropriate roles according to Section 3 of <span>[<a href="#RFC9234" class="cite xref">RFC9234</a>]</span> to enable prefix filtering based on BGP relationships.
                        Furthermore, for prefixes imported from upstreams, the OTC attribute <span class="bcp14">SHOULD</span> be set and evaluated according to <span>[<a href="#RFC9234" class="cite xref">RFC9234</a>]</span>, Section 5:<a href="#section-7.5.1-1" class="pilcrow">¶</a></p>
<div id="sec-filtering-outbound-prefixes-roles-import">
<section id="section-7.5.1.1">
            <h5 id="name-route-import">
<a href="#section-7.5.1.1" class="section-number selfRef">7.5.1.1. </a><a href="#name-route-import" class="section-name selfRef">Route Import</a>
            </h5>
<p id="section-7.5.1.1-1">
                            When OTC is being used, and a route is received, it should be handled as follows:<a href="#section-7.5.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.5.1.1-2.1">
                                If OTC is set, and it is received from a customer or RS-Client, it is a routeleak and <span class="bcp14">MUST</span> be discarded.<a href="#section-7.5.1.1-2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-7.5.1.1-2.2">
                                If OTC is set, and it is received from a peer and its value is not equal to the peer's AS number, it is a routeleak and <span class="bcp14">MUST</span> be discarded.<a href="#section-7.5.1.1-2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-7.5.1.1-2.3">
                                If OTC is not set, and it is received from an upstream, a peer, or an RS, it <span class="bcp14">MUST</span> be set to the AS number of the remote AS.<a href="#section-7.5.1.1-2.3" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
<div id="sec-filtering-outbound-prefixes-roles-export">
<section id="section-7.5.1.2">
            <h5 id="name-route-export">
<a href="#section-7.5.1.2" class="section-number selfRef">7.5.1.2. </a><a href="#name-route-export" class="section-name selfRef">Route Export</a>
            </h5>
<ul class="normal">
<li class="normal" id="section-7.5.1.2-1.1">
                                When advertising a route to a customer, peer, or (as a Routeserver) to an RS-Client, the OTC attribute <span class="bcp14">MUST</span> be set if it is not already present.<a href="#section-7.5.1.2-1.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-7.5.1.2-1.2">
                                Routes that have the OTC attribute set <span class="bcp14">MUST NOT</span> be exported to upstreams, peers, or routeservers.<a href="#section-7.5.1.2-1.2" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
</section>
</div>
<div id="sec-filtering-outbound-prefixes-communities">
<section id="section-7.5.2">
          <h4 id="name-outbound-filtering-using-la">
<a href="#section-7.5.2" class="section-number selfRef">7.5.2. </a><a href="#name-outbound-filtering-using-la" class="section-name selfRef">Outbound Filtering Using Large-Communities</a>
          </h4>
<p id="section-7.5.2-1">
                        Despite a fall-back mechanism being implemented to support one-sided BGP roles, they must be supported by both neighbors in a BGP session to be fully effective.
                        To completely cover an AS, all neighbors should utilize BGP roles on their sessions.
                        Hence, if at least one neighbor does not yet utilize BGP roles, or if the operator cannot deploy BGP roles and/or use the OTC attribute on their own infrastructure, operators <span class="bcp14">SHOULD</span> additionally utilize BGP large-communities to annotate where they learned prefixes and filter accordingly on sessions where they re-announce these prefixes, see <span>[<a href="#RFC8195" class="cite xref">RFC8195</a>]</span>.
                        While technically possible, standard BGP communities (see <span>[<a href="#RFC1997" class="cite xref">RFC1997</a>]</span>) <span class="bcp14">SHOULD NOT</span> be used for this purpose due to the prevalence of 32bit ASNs which can only be represented in large-communities (see <span>[<a href="#RFC8092" class="cite xref">RFC8092</a>]</span>).<a href="#section-7.5.2-1" class="pilcrow">¶</a></p>
<p id="section-7.5.2-2">
                        Operators <span class="bcp14">SHOULD</span> designate a large community namespace for each neighbor relationship, for example, OPERATOR_ASN:100:NEIGHBOR_ASN for upstreams, OPERATOR_ASN:101:NEIGHBOR_ASN for peers, OPERATOR_ASN:102:NEIGHBOR_ASN for downstreams, etc.
                        These communities <span class="bcp14">SHOULD</span> cover all relationships documented in Section 3 of <span>[<a href="#RFC9234" class="cite xref">RFC9234</a>]</span>.
                        Additionally, if operators allow downstreams to announce more specifics than generally accepted in the GRT (see <span>[<a href="#CCR-22" class="cite xref">CCR-22</a>]</span>), they should dedicate a large-community list to that purpose as well, to ensure they can effectively prevent re-announcements of these prefixes.<a href="#section-7.5.2-2" class="pilcrow">¶</a></p>
<p id="section-7.5.2-3">
                        For information on how these annotations <span class="bcp14">SHOULD</span> be included in filter sets, please see <a href="#sec-prefix-filtering-rec" class="auto internal xref">Section 9</a>.<a href="#section-7.5.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-ixp-lan-prefixes">
<section id="section-7.6">
        <h3 id="name-ixp-lan-prefixes">
<a href="#section-7.6" class="section-number selfRef">7.6. </a><a href="#name-ixp-lan-prefixes" class="section-name selfRef">IXP LAN Prefixes</a>
        </h3>
<div id="sec-network-security">
<section id="section-7.6.1">
          <h4 id="name-ixp-lan-prefix-filtering">
<a href="#section-7.6.1" class="section-number selfRef">7.6.1. </a><a href="#name-ixp-lan-prefix-filtering" class="section-name selfRef">IXP LAN Prefix Filtering</a>
          </h4>
<p id="section-7.6.1-1">
                        Within the IXP community, most IXPs prefer the IXP LAN prefix to not be advertised to the GRT (<span>[<a href="#TBD" class="cite xref">TBD</a>]</span>).
                        While some IXPs may opt to advertise the IXP LAN prefix, e.g., with the route server's ASN, operators present on an IXP <span class="bcp14">MUST</span> respect the choice of the IXP regarding the advertisement state of the IXP LAN prefix.
                        Furthermore, e.g., the RIPE region now reached consensus on reducing the initial IXP allocation size for IPv4 (see <span>[<a href="#RIPE-804" class="cite xref">RIPE-804</a>]</span>) above their own limits on maximum prefix lengths acceptable in the GRT (see  <span>[<a href="#RIPE-399" class="cite xref">RIPE-399</a>]</span> and <span>[<a href="#RIPE-532" class="cite xref">RIPE-532</a>]</span>).
                        When a network is present on an IXP and has sessions with other IXP members over a common subnet (IXP LAN prefix), it <span class="bcp14">SHOULD NOT</span> accept exact matches or more-specific prefixes for the IXP LAN prefix from any of its external BGP neighbors.
                        Accepting these routes may create a black hole for connectivity to the IXP LAN.
                        To reduce the risk of accidental route leaks of IXP LAN prefixes for which the corresponding IXP opted to not have them in the GRT, operators <span class="bcp14">MAY</span> choose to use "BGP next-hop-self" on all routes learned on that IXP to not be required to distribute the IXP LAN Prefix within their IGP.
                        Furthermore, IXPs may opt to create ROAs indicating AS0 as the only valid origin AS if they want to prevent their prefixes from being announced on the Internet.<a href="#section-7.6.1-1" class="pilcrow">¶</a></p>
<p id="section-7.6.1-2">
                        If the IXP LAN prefix is accepted at all, it <span class="bcp14">SHOULD</span> only be accepted from the ASes that the IXP authorizes to announce it -- this will usually be automatically achieved by filtering announcements using RPKI and/or IRR database.<a href="#section-7.6.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-prefix-cnt">
<section id="section-7.6.2">
          <h4 id="name-prefixes-on-routers-connect">
<a href="#section-7.6.2" class="section-number selfRef">7.6.2. </a><a href="#name-prefixes-on-routers-connect" class="section-name selfRef">Prefixes on Routers Connected to an IXP</a>
          </h4>
<p id="section-7.6.2-1">
                        It is suggested (see also <span>[<a href="#APNICTRN-17" class="cite xref">APNICTRN-17</a>]</span>), that operators dedicate routers for connections to an IXP that <span class="bcp14">SHOULD</span> only carry routes from the ASes cone, and not a full-table or default-route.
                        This reduces the chance of accidental route leaks and prevents other IXP members from pointing default routes via the IXP LAN to such a router.<a href="#section-7.6.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-pmtud-and-the-loose-urpf-problem">
<section id="section-7.6.3">
          <h4 id="name-pmtud-and-the-loose-urpf-pr">
<a href="#section-7.6.3" class="section-number selfRef">7.6.3. </a><a href="#name-pmtud-and-the-loose-urpf-pr" class="section-name selfRef">PMTUD and the Loose uRPF Problem</a>
          </h4>
<p id="section-7.6.3-1">
                        Originally, in order to have PMTUD working in the presence of loose uRPF, it would be necessary that all the networks that may source traffic that could flow through the IXP have a route for the IXP LAN prefix.
                        This relates to "packet too big" ICMP messages sent by IXP members' routers potentially being sourced using an address of the IXP LAN prefix.
                        In the presence of loose uRPF, this ICMP packet is dropped if there is no route for the IXP LAN prefix or a less specific route covering the IXP LAN prefix.<a href="#section-7.6.3-1" class="pilcrow">¶</a></p>
<p id="section-7.6.3-2">
                        Hence, similar to considerations in <a href="#sec-protection-of-the-bgp-speaker" class="auto internal xref">Section 4</a> regarding non globally routable transit networks, IXP members <span class="bcp14">SHOULD</span> ensure that "packet too big" ICMP messages sent by their routers have a source address in IP address space advertised to the GRT, e.g., the router's loopback address.
                        Note that this issue causes service interruption in case of lost "packet too big" messages, but may also reduce debuggability in, e.g., traceroutes.
                        If they decide to implement this behavior for all ICMP messages, operators <span class="bcp14">SHOULD</span> ensure that this address is only used for ICMP messages egressing via the interface connected to the IXP LAN.
                        Otherwise, readability of traceroutes will be significantly reduced, as the specific interface a packet passed through is no longer visible in traceroutes.<a href="#section-7.6.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-bgp-attribute-cleaning">
<section id="section-8">
      <h2 id="name-filtering-and-cleaning-base">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-filtering-and-cleaning-base" class="section-name selfRef">Filtering and Cleaning Based on Other BGP Aspects</a>
      </h2>
<div id="sec-bgp-route-flap-dampening">
<section id="section-8.1">
        <h3 id="name-bgp-route-flap-dampening">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-bgp-route-flap-dampening" class="section-name selfRef">BGP Route Flap Dampening</a>
        </h3>
<p id="section-8.1-1">
                    The BGP route flap dampening mechanism makes it possible to give penalties to routes each time they change in the BGP routing table.
                    Initially, this mechanism was created to protect the entire Internet from multiple events that impact a single network.
                    Studies have shown that implementations of BGP route flap dampening could cause more harm than benefit; therefore, in the past, the RIPE community has recommended against using BGP route flap dampening <span>[<a href="#RIPE-378" class="cite xref">RIPE-378</a>]</span>.
                    Later, studies were conducted to propose new route flap dampening thresholds in order to make the solution "usable"; see <span>[<a href="#RFC7196" class="cite xref">RFC7196</a>]</span> and <span>[<a href="#RIPE-580" class="cite xref">RIPE-580</a>]</span>  (in which RIPE reviewed its recommendations).
                    Following IETF and RIPE recommendations and using BGP route flap dampening with the adjusted configured thresholds is <span class="bcp14">RECOMMENDED</span>.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-maximum-prefixes">
<section id="section-8.2">
        <h3 id="name-maximum-prefixes">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-maximum-prefixes" class="section-name selfRef">Maximum Prefixes</a>
        </h3>
<p id="section-8.2-1">
                    A spike in the number of received and imported prefixes can be a threat to the availability of a BGP speaker.
                    Furthermore, a significant increase in the number of prefixes received from a neighbor might indicate a misconfiguration, e.g., a failure in outbound filtering for the advertising neighbor, or a failure in inbound filtering in the ingesting neighbor.
                    Finally, it is important to limit the overall GRT growth given theoretical attacks utilizing deaggregation of IPv6 prefixes to globally exhaust routers' memory and CPU capacity (see <span>[<a href="#KIRIN-22" class="cite xref">KIRIN-22</a>]</span>), the number of prefixes accepted to be originated by a neighboring AS across all BGP sessions should be limited.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<div id="sec-maximum-prefixes-on-a-peering">
<section id="section-8.2.1">
          <h4 id="name-maximum-prefixes-on-a-singl">
<a href="#section-8.2.1" class="section-number selfRef">8.2.1. </a><a href="#name-maximum-prefixes-on-a-singl" class="section-name selfRef">Maximum Prefixes on a Single Session</a>
          </h4>
<p id="section-8.2.1-1">
                        It is <span class="bcp14">RECOMMENDED</span> to configure a limit on the number of routes to be accepted from a neighbor.
                        The following rules are generally <span class="bcp14">RECOMMENDED</span>:<a href="#section-8.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2.1-2.1">
                            For peers, it is <span class="bcp14">RECOMMENDED</span> to have a limit lower than the number of routes in the Internet.
                            This will shut down the BGP session if the neighbor suddenly advertises the full table.
                            Operators can also configure different limits for each neighbor to which they have a peering relationshipt, according to the number of routes they are supposed to advertise,  plus some headroom to permit growth.
                            However, please note that these limits may change over time.
                            Hence, it is <span class="bcp14">RECOMMENDED</span> that both neighbors clearly communicate the number of prefixes they expect to announce to each other and agree on a way to automatically update this information in the future.
                            At the time of writing, (<span>[<a href="#PeeringDB" class="cite xref">PeeringDB</a>]</span>) is a common source for programmatically obtaining suggested prefix limits for neighbors.
                            In the absence of communicated prefix limits, the number of expected prefixes can be inferred from the AS-SET, see <a href="#sec-prefix-filters-created-from-internet-routing-registries-irrs-assets" class="auto internal xref">Section 7.1.2</a>.
                            It is <span class="bcp14">RECOMMENDED</span> to include additional headroom of 20% when utilizing an inferred prefix limit.<a href="#section-8.2.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.2.1-2.2">
                            From upstreams that provide full routing, it is <span class="bcp14">RECOMMENDED</span> to have a limit higher than the number of routes in the Internet.
                            A limit is still useful in order to protect the network (and in particular, the routers' memory) if too many routes are sent by the upstream.
                            The limit should be chosen according to the number of routes that can actually be handled by routers.<a href="#section-8.2.1-2.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-8.2.1-3">
                        It is important to regularly review the limits that are configured as the Internet can quickly change over time.
                        Some vendors propose mechanisms to have two thresholds: while the higher number specified will shut down the session, the first threshold will only trigger a log and can be used to passively adjust limits based on observations made on the network.<a href="#section-8.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-maximum-prefixes-per-as">
<section id="section-8.2.2">
          <h4 id="name-maximum-prefixes-per-neighb">
<a href="#section-8.2.2" class="section-number selfRef">8.2.2. </a><a href="#name-maximum-prefixes-per-neighb" class="section-name selfRef">Maximum Prefixes per Neighboring AS</a>
          </h4>
<p id="section-8.2.2-1">
                        With RPKI allowing operators to sign ROAs specifying a minimum and maximum prefix length (contrary to ROUTE/ROUTE6 objects), researchers noted that this allows deaggregation attacks (<span>[<a href="#KIRIN-22" class="cite xref">KIRIN-22</a>]</span>).
                        By configuring a ROA that cover an, e.g., /32, one can effectively authorize an AS to announce 65536 unique prefixes.
                        Leveraging the by now large availability of free and/or cheap opportunities to obtain IPv6 upstream, a malicious party could leverage this to cause significant Internet wide route churn and GRT growth.
                        By constantly advertising and withdrawing prefixes, churn exceeding the size of the IPv6 fulltable at the time of writing (around 200k prefixes) could be created by constantly announcing and withdrawing prefixes to upstream ASes at various PoPs.<a href="#section-8.2.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2.2-2">
                        It is therefore <span class="bcp14">RECOMMENDED</span> that operators, in addition to per-session prefix limits, implement a global limit to the number of prefixes they accept per neighboring AS.
                        As with the per-session limits, these <span class="bcp14">SHOULD</span> be sensible and regularly updated in coordination with operators from neighboring ASes.<a href="#section-8.2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-as-path-filtering">
<section id="section-8.3">
        <h3 id="name-as-path-filtering">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-as-path-filtering" class="section-name selfRef">AS Path Filtering</a>
        </h3>
<p id="section-8.3-1">
                    This section lists the <span class="bcp14">RECOMMENDED</span> practices when processing BGP AS paths in addition the considerations from <a href="#sec-prefix-filtering" class="auto internal xref">Section 7</a>.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3-2.1">
                        Operators <span class="bcp14">SHOULD</span> should follow <a href="#sec-rir-allocated-prefix-filters" class="auto internal xref">Section 7.1</a> to only accept 2-byte or 4-byte AS paths from customers containing ASNs belonging to (or authorized to transit through) the customer.
                        If operators cannot build and generate filtering expressions to implement this, they <span class="bcp14">SHOULD</span> consider accepting only path lengths relevant to the type of customer they have (as in, if these customers are a leaf or have customers of their own) and <span class="bcp14">SHOULD</span> try to discourage excessive prepending in such paths.
                        This loose policy <span class="bcp14">SHOULD</span> be combined with filters for specific 2-byte or 4-byte AS paths that must not be accepted if advertised by the customer, such as upstream transit providers or peer ASNs.<a href="#section-8.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.3-2.2">
                        Operators <span class="bcp14">SHOULD NOT</span> accept prefixes with private AS numbers in the AS path unless the prefixes are from customers.
                        In any case, operators <span class="bcp14">SHOULD NOT</span> re-export prefixes with AS paths containing private AS numbers.
                        An exception could occur when an upstream is offering some particular service like black-hole origination based on a private AS number:
                        in that case, prefixes <span class="bcp14">SHOULD</span> be accepted.
                        Customers should be informed by their upstream in order to put in place ad hoc policy to use such services.<a href="#section-8.3-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.3-2.3">
                        Operators <span class="bcp14">SHOULD NOT</span> accept prefixes when the first AS number in the AS path is not the one of the neighbor unless the BGP session is setup towards a BGP route server <span>[<a href="#RFC7947" class="cite xref">RFC7947</a>]</span>  (for example, on an IXP) with transparent AS path handling.
                        In that case, this verification needs to be deactivated, as the first AS number will be the one of an IXP member, whereas the neighbor's AS number will be the one of the BGP route server.<a href="#section-8.3-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.3-2.4">
                        Operators <span class="bcp14">SHOULD NOT</span> advertise prefixes with a nonempty AS path unless they are either announcing prefixes from the GRT to downstreams, or if the whole AS path is within their cone.<a href="#section-8.3-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.3-2.5">
                        Operators <span class="bcp14">SHOULD NOT</span> advertise prefixes with upstream AS numbers in the AS path to any AS except to those to which they provide upstream transit.<a href="#section-8.3-2.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.3-2.6">
                        Private AS numbers are conventionally used in contexts that are "private" and <span class="bcp14">SHOULD NOT</span> be used in advertisements to BGP neighbors that are not party to such private arrangements, and they <span class="bcp14">SHOULD</span> be stripped when received from BGP neighbors that are not party to such private arrangements.
                        Additionally, operators <span class="bcp14">MAY</span> decide to not accept prefixes with private AS numbers in their AS path at all.<a href="#section-8.3-2.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.3-2.7">
                        Operators <span class="bcp14">SHOULD NOT</span> accept their own AS number in the AS path by overriding BGP's default behavior.
                        When considering an exception, the impact (which may be severe on routing) should be evaluated carefully.<a href="#section-8.3-2.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.3-2.8">
                        Overly long AS path, i.e., longer than 64 entries, may cause issues for some older routing hardware.
                        Hence, operators <span class="bcp14">SHOULD NOT</span> use excessive prepending when advertising prefixes.
                        Excessive prepending is defined as any prepending that leads to an AS path exceeding 64 entries across the GRT.
                        Additionally, it is <span class="bcp14">RECOMMENDED</span> that operators filter any prefix advertised with an AS path of more than 64 entries.<a href="#section-8.3-2.8" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.3-3">
                    AS path filtering should be further analyzed when ASN renumbering is done.
                    Such an operation is common, and mechanisms exist to allow smooth ASN migration <span>[<a href="#RFC7705" class="cite xref">RFC7705</a>]</span>.
                    The usual migration technique, local to a router, consists in modifying the AS path so it is presented to a neighbor with the previous ASN, as if no renumbering was done.
                    This makes it possible to change the ASN of a router without reconfiguring all eBGP neighbors at the same time (as that operation would require synchronization with all neighbors attached to that router).
                    During this renumbering operation, the rules described above may be adjusted.<a href="#section-8.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-next-hop-filtering">
<section id="section-8.4">
        <h3 id="name-next-hop-filtering">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-next-hop-filtering" class="section-name selfRef">Next-Hop Filtering</a>
        </h3>
<p id="section-8.4-1">
                    When establishing sessions via a shared network, like an IXP, BGP can advertise prefixes with a third-party next hop, thus directing packets not to the neighbor announcing the prefix but somewhere else.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<p id="section-8.4-2">
                    This is a desirable property for BGP route-server setups <span>[<a href="#RFC7947" class="cite xref">RFC7947</a>]</span>, where the route server will relay routing information but has neither the capacity nor the desire to receive the actual data packets.
                    So, the BGP route server will announce prefixes with a next-hop setting pointing to the router that originally announced the prefix to the route server.<a href="#section-8.4-2" class="pilcrow">¶</a></p>
<p id="section-8.4-3">
                    In direct sessions between ASes via an IXP LAN, this is undesirable, as one of the neighbors could trick the other one into sending packets into a black hole (unreachable next hop) or to an unsuspecting third party who would then have to carry the traffic.
                    Especially for black-holing, the root cause of the problem is hard to see without inspecting BGP prefixes at the receiving router of the IXP.<a href="#section-8.4-3" class="pilcrow">¶</a></p>
<p id="section-8.4-4">
                    Therefore, an inbound route policy <span class="bcp14">SHOULD</span> be applied on direct sessions via an IXP LAN in order to set the next hop for accepted prefixes to the BGP neighbor's IP address (belonging to the IXP LAN) that sent the prefix (which is what "next-hop-self" would enforce on the sending side).<a href="#section-8.4-4" class="pilcrow">¶</a></p>
<p id="section-8.4-5">
                    This policy <span class="bcp14">SHOULD NOT</span> be used on sessions with route-servers or on sessions where operators intentionally permit the other side to send third-party next hops.<a href="#section-8.4-5" class="pilcrow">¶</a></p>
<p id="section-8.4-6">
                    This policy also <span class="bcp14">SHOULD</span> be adjusted if the best practice of Remote Triggered Black Holing (aka RTBH as described in <span>[<a href="#RFC6666" class="cite xref">RFC6666</a>]</span>) is implemented.
                    In that case, operators would apply a well-known BGP next hop for routes they want to filter (if an Internet threat is observed from/to this route, for example).
                    This well-known next hop will be statically routed to a null interface.
                    In combination with a unicast RPF check, this will discard traffic from and toward this prefix.
                    BGP speakers can exchange information about black holes using, for example, particular BGP communities, see <span>[<a href="#RFC6666" class="cite xref">RFC6666</a>]</span>.
                    Operators could propagate black-hole information to their neighbors using an agreed-upon BGP community: when receiving a route with that community, a configured policy could change the next hop in order to create the black hole.<a href="#section-8.4-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-bgp-community-scrubbing">
<section id="section-8.5">
        <h3 id="name-bgp-community-scrubbing">
<a href="#section-8.5" class="section-number selfRef">8.5. </a><a href="#name-bgp-community-scrubbing" class="section-name selfRef">BGP Community Scrubbing</a>
        </h3>
<p id="section-8.5-1">
                    Optionally, we can consider the following rules on received NLRI:<a href="#section-8.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.5-2.1">
                        Operators <span class="bcp14">SHOULD</span> scrub inbound communities with their ASN in the high-order bits, unless they have been documented and communicated to neighbors to be used as a signaling mechanism.
                        Operators <span class="bcp14">SHOULD</span> scrub inbound large-communities with their ASN in the high-order bits, unless they have been documented and communicated to neighbors to be used as a signaling mechanism.<a href="#section-8.5-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.5-2.2">
                        Networks administrators <span class="bcp14">SHOULD NOT</span> remove other communities applied on received routes (communities not removed after application of the previous statement).
                        In particular, they <span class="bcp14">SHOULD</span> keep original communities when they apply a community.
                        Customers might need them to communicate with upstream providers.
                        In particular, operators <span class="bcp14">SHOULD NOT</span> (generally) remove the no-export community, as it is usually announced by their neighbor for a certain purpose.
                        Similarly, network operators should not remove RTBH related communities if send by the customer for a prefix of routable size.<a href="#section-8.5-2.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="sec-bgp-attribute-scrubbing">
<section id="section-8.6">
        <h3 id="name-bgp-attribute-scrubbing">
<a href="#section-8.6" class="section-number selfRef">8.6. </a><a href="#name-bgp-attribute-scrubbing" class="section-name selfRef">BGP Attribute Scrubbing</a>
        </h3>
<p id="section-8.6-1">
                    Over the past years several instances of network disruptions due to routers being unable to process specific BGP attributes were encountered.
                    As such, operators <span class="bcp14">MAY</span> opt to scrub all BGP attributes known to cause service disruptions on their infrastructure.<a href="#section-8.6-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-prefix-filtering-rec">
<section id="section-9">
      <h2 id="name-prefix-filtering-recommenda">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-prefix-filtering-recommenda" class="section-name selfRef">Prefix Filtering Recommendations</a>
      </h2>
<div id="sec-prefix-filtering-considerations">
<section id="section-9.1">
        <h3 id="name-prefix-filter-implementatio">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-prefix-filter-implementatio" class="section-name selfRef">Prefix Filter Implementation Considerations</a>
        </h3>
<p id="section-9.1-1">
                    Besides the overall generation of prefix filters and to which relationships these should be applied, the way how these can be implemented needs to be considered.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<div id="sec-prefix-filtering-considerations-order">
<section id="section-9.1.1">
          <h4 id="name-order-of-prefixfilters">
<a href="#section-9.1.1" class="section-number selfRef">9.1.1. </a><a href="#name-order-of-prefixfilters" class="section-name selfRef">Order of Prefixfilters</a>
          </h4>
<p id="section-9.1.1-1">
                        Most vendors apply filters and changes (route maps, prefix filters, and other actions) to imported and exported NLRIs following a pre-defined sequence, while allowing redirection to other rules.
                        This means that the application of prefix filters and other rules must avoid computationally expensive setups, or setups of rules that apply computation to NLRI that will subsequently be discarded.<a href="#section-9.1.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1.1-2">
                        Below, you can find an (incomplete) example for a simple inbound filter for a session with a neighbor in a peer relationship who has 60 prefixes in its cone creating additional load.
                        We assume that, accidentally, an IPv4 fulltable of 1,000,000 entries is being sent.
                        2,500 NLRI contain unregistered/private AS numbers, 500 NLRI relate to bogon prefixes, and 5,000 NLRI are RPKI invalid, with none of the routes in the neigbor's cone falling in any of these categories.
                        The number of operations per line are given in parentheses.<a href="#section-9.1.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.1.1-3.1">
                            1. Add community imported from peer (1,000,000)<a href="#section-9.1.1-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-9.1.1-3.2">
                            2. Add community imported in LOCATION (1,000,000)<a href="#section-9.1.1-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-9.1.1-3.3">
                            3. Reject NLRI with private AS numbers in the AS path (1,000,000)<a href="#section-9.1.1-3.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-9.1.1-3.4">
                            4. Reject bogon prefixes (997,500)<a href="#section-9.1.1-3.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-9.1.1-3.5">
                            5. Reject RPKI invalid NLRI (997,000)<a href="#section-9.1.1-3.5" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-9.1.1-3.6">
                            6. Accept only prefixes in the neighbor's cone (992,000)<a href="#section-9.1.1-3.6" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-9.1.1-4">
                        In this list, rules 1-5 will be executed for most NLRI seen from the neighbor.
                        In total, 5,986,500 operations are executed on the received NLRI, even though ultimately only 60 prefixes should be imported.<a href="#section-9.1.1-4" class="pilcrow">¶</a></p>
<p id="section-9.1.1-5">
                        While most hardware implementations of BGP speakers should be sufficiently equipped with resources to handle such individual spikes, practice shows that operators can not always use BGP speakers with an abundance of resources.
                        Furthermore, even more well equipped platforms may suffer if multiple neighbors coordinate and utilize this mechanic to induce load.
                        Ultimately, it is also desirable to reduce unnecessary computation independent of security considerations.<a href="#section-9.1.1-5" class="pilcrow">¶</a></p>
<p id="section-9.1.1-6">
                        Hence, it is <span class="bcp14">RECOMMENDED</span> that operators structure rulesets in a way that prioritized early decisions on the majority of routes.
                        For the example above, this would mean, again noting the number of operations per rule:<a href="#section-9.1.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.1.1-7.1">
                            1. Reject prefixes not in the neighbor's cone (1,000,000)<a href="#section-9.1.1-7.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-9.1.1-7.2">
                            2. Reject bogon prefixes (60)<a href="#section-9.1.1-7.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-9.1.1-7.3">
                            3. Reject NLRI with private AS numbers in the AS path (60)<a href="#section-9.1.1-7.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-9.1.1-7.4">
                            4. Reject RPKI invalid NLRI (60)<a href="#section-9.1.1-7.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-9.1.1-7.5">
                            5. Add community imported from peer (60)<a href="#section-9.1.1-7.5" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-9.1.1-7.6">
                            6. Add community imported in LOCATION (60)<a href="#section-9.1.1-7.6" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-9.1.1-8">
                        Overall, this reduces the number of operations for our hypothetical full-table from 5,986,500 operations to 1,000,300.
                        Similar effects can occur when not filtering on, e.g., the OTC attribute first when sending prefixes to customers.<a href="#section-9.1.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-prefix-filtering-considerations-change">
<section id="section-9.1.2">
          <h4 id="name-ensuring-consistency-when-c">
<a href="#section-9.1.2" class="section-number selfRef">9.1.2. </a><a href="#name-ensuring-consistency-when-c" class="section-name selfRef">Ensuring Consistency when Changing Prefixfilters</a>
          </h4>
<p id="section-9.1.2-1">
                        As discussed in <a href="#sec-prefix-filtering-considerations-order" class="auto internal xref">Section 9.1.1</a>, many BGP implementations use a sequential order for applying different prefix filters to ingested routes.
                        However, at the same time, several implementations do not perform atomic operations when applying rules.
                        This means that, especially on resource constraint BGP speakers or BGP speakers under load consistency of a ruleset may be lost during a rule-set update.<a href="#section-9.1.2-1" class="pilcrow">¶</a></p>
<p id="section-9.1.2-2">
                        For example, consider the following simplified export rule-set towards a peer:<a href="#section-9.1.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.1.2-3.1">
                            1. Reject prefixes learned from upstreams<a href="#section-9.1.2-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-9.1.2-3.2">
                            2. Reject bogon prefixes<a href="#section-9.1.2-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-9.1.2-3.3">
                            3. Reject RPKI invalid NLRI<a href="#section-9.1.2-3.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-9.1.2-3.4">
                            4. Accept all remaining prefixes<a href="#section-9.1.2-3.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-9.1.2-4">
                        If one now wants to swap the order of Rule 2 and 3, an implementation applying rule updates not atomically would proceed as follows:<a href="#section-9.1.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.1.2-5.1">
                            1. Delete Rule 2, Reject bogon prefixes<a href="#section-9.1.2-5.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-9.1.2-5.2">
                            2. Add Rule 2, Reject RPKI invalid NLRI<a href="#section-9.1.2-5.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-9.1.2-5.3">
                            3. Delete Rule 3, Reject RPKI invalid NLRI<a href="#section-9.1.2-5.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-9.1.2-5.4">
                            4. Add Rule 3, Reject bogon prefixes<a href="#section-9.1.2-5.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-9.1.2-6">
                        During the timeframe between the execution of Step 1 and 2, an NLRI for a bogon prefix would be passed by the filter.
                        While, technically, this timeframe should be negligibly small, a loaded control plane my create unexpected overhead allowing prefixes that should be filtered to pass.
                        Similarly, an error during the application of a ruleset, making the application stop after the execution of Step 1 may have a similar effect if rule-set changes are not atomic.<a href="#section-9.1.2-6" class="pilcrow">¶</a></p>
<p id="section-9.1.2-7">
                        Hence, it is <span class="bcp14">RECOMMENDED</span> that operators assess whether the application of changes to rule-sets on their BGP speakers is atomic.
                        If it is not atomic, operators <span class="bcp14">SHOULD</span> take special care in drafting rule-set updates concerning inconsistent state that could be created by a delayed or incomplete update.
                        If no atomicity is provided by the BGP speaker, and the load-conditions are uncertain, operators <span class="bcp14">SHOULD</span> consider creating a new complete rule-set with the desired changes, and then changing the referenced rule-set for a given neighbor instead of updating an existing rule-set in-place.
                        Naturally, after the new rule-set has been activated, the old rule-set should be deleted.<a href="#section-9.1.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-prefix-filtering-ruleset-size">
<section id="section-9.1.3">
          <h4 id="name-ruleset-size-considerations">
<a href="#section-9.1.3" class="section-number selfRef">9.1.3. </a><a href="#name-ruleset-size-considerations" class="section-name selfRef">Ruleset Size Considerations</a>
          </h4>
<p id="section-9.1.3-1">
                        Some BGP speaker implementations, and especially older BGP speakers, are restrained in terms of the number of prefixes and rules they can apply.
                        A common reaction of operators in such cases is reducing the number of filters applied on sessions.
                        Even though it is <span class="bcp14">NOT RECOMMENDED</span> to aggregate prefix lists for filtering, operators <span class="bcp14">SHOULD</span> consider aggressive aggregation of prefix filter lists to restrict the perfixes accepted by neighbors if the alternative is not using filters at all.<a href="#section-9.1.3-1" class="pilcrow">¶</a></p>
<p id="section-9.1.3-2">
                        Another approach that <span class="bcp14">MAY</span> be a suitable rule-set creation approach for downstreams and peers is offline validation.
                        In that case, a dedicated system regularly, e.g., every two hours, obtains the list of prefixes advertised by a given peer or downstream.
                        That list is then validated according to the applicable section below.
                        Subsequently, instead of using a full representation of the neighbors cone, a condensed prefix list matching the aggregate of the exact prefixes announced is generated and deployed to the BGP speaker.
                        While this increases the timeframe for newly added prefixes to be accepted, and may be unsuitable for, e.g., DDoS defense services, it can also reduce the size of prefix lists significantly.<a href="#section-9.1.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-prefix-filtering-ruleset-failure">
<section id="section-9.1.4">
          <h4 id="name-ruleset-generation-failure">
<a href="#section-9.1.4" class="section-number selfRef">9.1.4. </a><a href="#name-ruleset-generation-failure" class="section-name selfRef">Ruleset Generation Failure</a>
          </h4>
<p id="section-9.1.4-1">
                        As noted in <a href="#sec-prefix-filters-created-from-internet-routing-registries-irrs-creating-filters" class="auto internal xref">Section 7.1.3</a>, the creation and application of filter rules should be automated to reduce the margin for error and misconfigurations.
                        Nevertheless, the regeneration of filter rules may fail.<a href="#section-9.1.4-1" class="pilcrow">¶</a></p>
<p id="section-9.1.4-2">
                        Before applying a generated ruleset, an operator should check it for obvious errors and potentially require manual intervention to remediate the issue.
                        Examples include a ruleset for a neighbor suddenly significantly increasing or decreasing in size, or being empty.<a href="#section-9.1.4-2" class="pilcrow">¶</a></p>
<p id="section-9.1.4-3">
                        In case of such a failure, each administrator <span class="bcp14">MAY</span> decide which actions they will take.
                        Options include re-using the previously active rule set, or either accepting or rejecting all routes depending on routing policy.
                        Generally accepting all routes during that time frame could break BGP routing security.
                        However, rejecting them might re-route too much traffic towards upstreams, and could cause more harm than accepting invalid prefixes.
                        Similarly, reusing the previously active rule set may lead to prefixes being wrongfully accepted or rejected, despite on a smaller scale than for a general accept or reject decision.<a href="#section-9.1.4-3" class="pilcrow">¶</a></p>
<p id="section-9.1.4-4">
                        Hence, to still provide sufficient protection for an individual AS experiencing issues with rule generation, and therefore deciding to deviate to more permissive inbound filters, it is strongly <span class="bcp14">RECOMMENDED</span> that all BGP speakers in general employ inbound and outbound filtering as described in this document.<a href="#section-9.1.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-prefix-filtering-recommendations-in-full-routing-networks">
<section id="section-9.2">
        <h3 id="name-prefix-filtering-recommendat">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-prefix-filtering-recommendat" class="section-name selfRef">Prefix Filtering Recommendations in Full Routing Networks</a>
        </h3>
<p id="section-9.2-1">
                    For networks that have the full Internet BGP table, policies should be applied on each BGP neighbor for received and advertised routes.
                    It is <span class="bcp14">RECOMMENDED</span> that each Autonomous System configures rules for advertised and received routes at all its borders, as this will protect the network and its neighbors even in case of misconfiguration.
                    The most commonly used filtering policy is proposed in this section and uses prefix filters defined in <a href="#sec-static-prefix-filtering" class="auto internal xref">Section 6</a>, <a href="#sec-prefix-filtering" class="auto internal xref">Section 7</a>, and <a href="#sec-bgp-attribute-cleaning" class="auto internal xref">Section 8</a>.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<div id="sec-filters-with-internet-peers">
<section id="section-9.2.1">
          <h4 id="name-filters-with-internet-peers">
<a href="#section-9.2.1" class="section-number selfRef">9.2.1. </a><a href="#name-filters-with-internet-peers" class="section-name selfRef">Filters with Internet Peers</a>
          </h4>
<div id="sec-inbound-filtering-with-peers">
<section id="section-9.2.1.1">
            <h5 id="name-inbound-filtering">
<a href="#section-9.2.1.1" class="section-number selfRef">9.2.1.1. </a><a href="#name-inbound-filtering" class="section-name selfRef">Inbound Filtering</a>
            </h5>
<p id="section-9.2.1.1-1">
                            Inbound filtering on sessions with peers does not only ensure that an operator does not ingest maliciously or wrongfully advertised routes, but also serves as an additional safety net in case of unintentional misconfigurations.
                            For inbound filters with peers, the following rules <span class="bcp14">SHOULD</span> be applied in the given order to limit resource use on filter application (see <a href="#sec-prefix-filtering-considerations" class="auto internal xref">Section 9.1</a>).<a href="#section-9.2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-9.2.1.1-2">
                            The <span class="bcp14">RECOMMENDED</span> filters ensure advertisements strictly conform to what is declared in routing registries (<a href="#sec-rir-allocated-prefix-filters" class="auto internal xref">Section 7.1</a>).
                            Warning is given as registries are not always accurate (prefixes missing, wrong information, etc.).
                            This varies across the registries and regions of the Internet.
                            Hence, before applying this policy, the reader <span class="bcp14">SHOULD</span> check the impact on the filter and make sure no prefixes are filtered that should actually be accepted.<a href="#section-9.2.1.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2.1.1-3.1">
                                1. All prefixes not in the neighbor's cone based on IRR data (<a href="#sec-rir-allocated-prefix-filters" class="auto internal xref">Section 7.1</a>)<a href="#section-9.2.1.1-3.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.1.1-3.2">
                                2. Prefixes not allocated by IANA (IPv6 only) (<a href="#sec-iana-allocated-prefix-filters" class="auto internal xref">Section 6.2.1</a>)<a href="#section-9.2.1.1-3.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.1.1-3.3">
                                3. RPKI invalid prefixes (<a href="#sec-sidr-rov" class="auto internal xref">Section 7.2.1</a>)<a href="#section-9.2.1.1-3.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.1.1-3.4">
                                4. Prefixes with an invalid AS path (ASPA) (<a href="#sec-sidr-aspa" class="auto internal xref">Section 7.2.2</a>)<a href="#section-9.2.1.1-3.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.1.1-3.5">
                                5. Prefixes with an invalid AS path (longer than 64 entries) (<a href="#sec-as-path-filtering" class="auto internal xref">Section 8.3</a>)<a href="#section-9.2.1.1-3.5" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.1.1-3.6">
                                6. Prefixes with an invalid AS path (containing private or reserved AS numbers) (<a href="#sec-as-path-filtering" class="auto internal xref">Section 8.3</a>)<a href="#section-9.2.1.1-3.6" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.1.1-3.7">
                                7. Prefixes belonging to the local AS (<a href="#sec-filtering-prefixes-belonging-to-the-local-as" class="auto internal xref">Section 7.3</a>)<a href="#section-9.2.1.1-3.7" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.1.1-3.8">
                                7.1. Optionally: Reprioritizing prefixes belonging to the local AS' cone instead of filtering them (<a href="#sec-filtering-inbound-prefixes-belonging-to-ds" class="auto internal xref">Section 7.4</a>)<a href="#section-9.2.1.1-3.8" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.1.1-3.9">
                                8. Prefixes that are not globally routable (<a href="#sec-special-purpose-prefixes" class="auto internal xref">Section 6.1</a>)<a href="#section-9.2.1.1-3.9" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.1.1-3.10">
                                9. IXP LAN prefixes of IXPs the local AS is connected to (<a href="#sec-ixp-lan-prefixes" class="auto internal xref">Section 7.6</a>)<a href="#section-9.2.1.1-3.10" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.1.1-3.11">
                                10. The default route (<a href="#sec-the-default-route" class="auto internal xref">Section 6.4</a>)<a href="#section-9.2.1.1-3.11" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.1.1-3.12">
                                11. Routes not matching the neighbor's next-hop (<a href="#sec-next-hop-filtering" class="auto internal xref">Section 8.4</a>)<a href="#section-9.2.1.1-3.12" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.1.1-3.13">
                                12. Routes that are too specific or too unspecific (<a href="#sec-prefixes-that-are-too-specific" class="auto internal xref">Section 6.3</a>)<a href="#section-9.2.1.1-3.13" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-9.2.1.1-4">
                            Note that Rule 12 <span class="bcp14">MAY</span> be formulated as an acceptance rule, i.e., accepting all prefixes that are between a /8 and a /24 for IPv4 and between a /16 and a /48 for IPv6.<a href="#section-9.2.1.1-4" class="pilcrow">¶</a></p>
<p id="section-9.2.1.1-5">
                            Additionally, Rule 11 <span class="bcp14">MUST NOT</span> be set for sessions with IXP routeservers, while it <span class="bcp14">SHOULD</span> be set on direct sessions via IXP LANs (see <a href="#sec-ixp-lan-prefixes" class="auto internal xref">Section 7.6</a>).<a href="#section-9.2.1.1-5" class="pilcrow">¶</a></p>
<p id="section-9.2.1.1-6">
                            If BGP roles are used, the OTC attribute should be set according to <span>[<a href="#RFC9234" class="cite xref">RFC9234</a>]</span>.<a href="#section-9.2.1.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-outbound-filtering-with-peers">
<section id="section-9.2.1.2">
            <h5 id="name-outbound-filtering">
<a href="#section-9.2.1.2" class="section-number selfRef">9.2.1.2. </a><a href="#name-outbound-filtering" class="section-name selfRef">Outbound Filtering</a>
            </h5>
<p id="section-9.2.1.2-1">
                            The configuration should ensure that only appropriate prefixes are sent, i.e., prefixes a neighbour would not need to filter based on <a href="#sec-inbound-filtering-with-peers" class="auto internal xref">Section 9.2.1.1</a>.
                            These can be, for example, prefixes belonging to both the network in question and its downstreams.
                            This can be achieved by using BGP communities, AS paths, or both.<a href="#section-9.2.1.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2.1.2-2">
                            Also, it may be desirable to add the following filters before any further policy to avoid unwanted route announcements due to bad configuration:<a href="#section-9.2.1.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2.1.2-3.1">
                                1. All prefixes not in the local AS' cone based on IRR/Internal data (<a href="#sec-rir-allocated-prefix-filters" class="auto internal xref">Section 7.1</a>)<a href="#section-9.2.1.2-3.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.1.2-3.2">
                                2. All prefixes with the OTC attribute set evaluated according to <span>[<a href="#RFC9234" class="cite xref">RFC9234</a>]</span> (<a href="#sec-filtering-outbound-prefixes-roles" class="auto internal xref">Section 7.5.1</a>)<a href="#section-9.2.1.2-3.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.1.2-3.3">
                                3. Prefixes not allocated by IANA (IPv6 only) (<a href="#sec-iana-allocated-prefix-filters" class="auto internal xref">Section 6.2.1</a>)<a href="#section-9.2.1.2-3.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.1.2-3.4">
                                4. RPKI invalid prefixes (<a href="#sec-sidr-rov" class="auto internal xref">Section 7.2.1</a>)<a href="#section-9.2.1.2-3.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.1.2-3.5">
                                5. Prefixes with an invalid AS path (ASPA) (<a href="#sec-sidr-aspa" class="auto internal xref">Section 7.2.2</a>)<a href="#section-9.2.1.2-3.5" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.1.2-3.6">
                                6. Prefixes with an invalid AS path (longer than 64 entries) (<a href="#sec-as-path-filtering" class="auto internal xref">Section 8.3</a>)<a href="#section-9.2.1.2-3.6" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.1.2-3.7">
                                7. Prefixes with an invalid AS path (containing private or reserved AS numbers) (<a href="#sec-as-path-filtering" class="auto internal xref">Section 8.3</a>)<a href="#section-9.2.1.2-3.7" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.1.2-3.8">
                                8. Prefixes that are not globally routable (<a href="#sec-special-purpose-prefixes" class="auto internal xref">Section 6.1</a>)<a href="#section-9.2.1.2-3.8" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.1.2-3.9">
                                9. The default route (<a href="#sec-the-default-route" class="auto internal xref">Section 6.4</a>)<a href="#section-9.2.1.2-3.9" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.1.2-3.10">
                                11. Routes not intended for re-export (<a href="#sec-filtering-outbound-prefixes" class="auto internal xref">Section 7.5</a>)<a href="#section-9.2.1.2-3.10" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.1.2-3.11">
                                12. Routes not listing the BGP speaker as the next-hop (<a href="#sec-next-hop-filtering" class="auto internal xref">Section 8.4</a>)<a href="#section-9.2.1.2-3.11" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.1.2-3.12">
                                13. Routes that are too specific or too unspecific (<a href="#sec-prefixes-that-are-too-specific" class="auto internal xref">Section 6.3</a>)<a href="#section-9.2.1.2-3.12" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-9.2.1.2-4">
                            If it is possible to list the prefixes to be advertised, then just configuring the list of allowed prefixes and denying the rest is technically sufficient.
                            Nevertheless, to ensure robustness in case of failure, especially for manually operated BGP speakers, it is <span class="bcp14">RECOMMENDED</span> that operators apply the full rule-set.<a href="#section-9.2.1.2-4" class="pilcrow">¶</a></p>
<p id="section-9.2.1.2-5">
                            Note that Rule 12 is technically not necessary for eBGP.
                            However, in some rare cases misconfigurations or implementation errors may occur, especially for sessions with a neighbor via an IXP LAN (directly or indirectly), where the implementation on the BGP speaker might export routes with a non-local next-hop.
                            While Rule 12 could prevent disturbance in such cases, the likelihood of such events is sufficiently low that operators <span class="bcp14">MAY</span> opt to not use Rule 12.<a href="#section-9.2.1.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-filters-with-customers">
<section id="section-9.2.2">
          <h4 id="name-filters-with-customers">
<a href="#section-9.2.2" class="section-number selfRef">9.2.2. </a><a href="#name-filters-with-customers" class="section-name selfRef">Filters with Customers</a>
          </h4>
<div id="sec-inbound-filtering-with-customers">
<section id="section-9.2.2.1">
            <h5 id="name-inbound-filtering-2">
<a href="#section-9.2.2.1" class="section-number selfRef">9.2.2.1. </a><a href="#name-inbound-filtering-2" class="section-name selfRef">Inbound Filtering</a>
            </h5>
<p id="section-9.2.2.1-1">
                            From customers, only customer prefixes <span class="bcp14">SHOULD</span> be accepted, all others <span class="bcp14">SHOULD</span> be discarded.
                            However, additionally, an operator should ensure that prefixes announced by customers also conform to best practices in terms of other BGP aspects (AS path, IRR compliance, RPKI etc.)
                            Not doing so might lead to intransparent failures when the customer is able to export routes to the upstream, but these are then not ingested by the upstream's neighbors.
                            Applying filtering close to the source ensures better debugability for such issues.<a href="#section-9.2.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2.2.1-2.1">
                                1. All prefixes not in the neighbor's cone based on IRR data (<a href="#sec-rir-allocated-prefix-filters" class="auto internal xref">Section 7.1</a>)<a href="#section-9.2.2.1-2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.2.1-2.2">
                                2. Prefixes not allocated by IANA (IPv6 only) (<a href="#sec-iana-allocated-prefix-filters" class="auto internal xref">Section 6.2.1</a>)<a href="#section-9.2.2.1-2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.2.1-2.3">
                                3. RPKI invalid prefixes (<a href="#sec-sidr-rov" class="auto internal xref">Section 7.2.1</a>)<a href="#section-9.2.2.1-2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.2.1-2.4">
                                4. Prefixes with an invalid AS path (ASPA) (<a href="#sec-sidr-aspa" class="auto internal xref">Section 7.2.2</a>)<a href="#section-9.2.2.1-2.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.2.1-2.5">
                                5. Prefixes with an invalid AS path (longer than 64 entries) (<a href="#sec-as-path-filtering" class="auto internal xref">Section 8.3</a>)<a href="#section-9.2.2.1-2.5" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.2.1-2.6">
                                6. Prefixes with an invalid AS path (containing private or reserved AS numbers) (<a href="#sec-as-path-filtering" class="auto internal xref">Section 8.3</a>)<a href="#section-9.2.2.1-2.6" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.2.1-2.7">
                                7. Prefixes belonging to the local AS (<a href="#sec-filtering-prefixes-belonging-to-the-local-as" class="auto internal xref">Section 7.3</a>)<a href="#section-9.2.2.1-2.7" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.2.1-2.8">
                                8. Prefixes that are not globally routable (<a href="#sec-special-purpose-prefixes" class="auto internal xref">Section 6.1</a>)<a href="#section-9.2.2.1-2.8" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.2.1-2.9">
                                9. IXP LAN prefixes of IXPs the local AS is connected to (<a href="#sec-ixp-lan-prefixes" class="auto internal xref">Section 7.6</a>)<a href="#section-9.2.2.1-2.9" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.2.1-2.10">
                                10. The default route (<a href="#sec-the-default-route" class="auto internal xref">Section 6.4</a>)<a href="#section-9.2.2.1-2.10" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.2.1-2.11">
                                11. Routes not matching the neighbor's next-hop (<a href="#sec-next-hop-filtering" class="auto internal xref">Section 8.4</a>)<a href="#section-9.2.2.1-2.11" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.2.1-2.12">
                                12. Routes that are too specific or too unspecific (<a href="#sec-prefixes-that-are-too-specific" class="auto internal xref">Section 6.3</a>)<a href="#section-9.2.2.1-2.12" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-9.2.2.1-3">
                            Technically, the inbound policy with end customers is pretty straightforward: only customer prefixes <span class="bcp14">SHOULD</span> be accepted, all others <span class="bcp14">SHOULD</span> be discarded.
                            For smaller downstreams, the list of accepted prefixes can be manually specified, after having verified that they are valid.
                            This validation can be done with the appropriate IP address management authorities.
                            For larger downstreams, an approach as documented in <a href="#sec-prefix-filtering-ruleset-size" class="auto internal xref">Section 9.1.3</a> <span class="bcp14">MAY</span> also be suitable.<a href="#section-9.2.2.1-3" class="pilcrow">¶</a></p>
<p id="section-9.2.2.1-4">
                            Additionally, Rule 11 <span class="bcp14">MUST NOT</span> be set in the rare case of an IXP routeserver providing upstream (see <span>[<a href="#CommunityIX" class="cite xref">CommunityIX</a>]</span>), while it <span class="bcp14">SHOULD</span> be set when providing upstream to a customer with a direct session via IXP LANs (see <a href="#sec-next-hop-filtering" class="auto internal xref">Section 8.4</a>).<a href="#section-9.2.2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-outbound-filtering-with-customers">
<section id="section-9.2.2.2">
            <h5 id="name-outbound-filtering-2">
<a href="#section-9.2.2.2" class="section-number selfRef">9.2.2.2. </a><a href="#name-outbound-filtering-2" class="section-name selfRef">Outbound Filtering</a>
            </h5>
<p id="section-9.2.2.2-1">
                            The outbound policy with customers may vary according to the routes the customer wants to receive.
                            In the simplest possible scenario, the customer may want to receive only the default route; this can be done easily by applying a filter with the default route only.<a href="#section-9.2.2.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2.2.2-2">
                            In case the customer wants to receive the full routing table (if it is multihomed or if it wants to have a view of the Internet table), the following filters <span class="bcp14">SHOULD</span> be applied on the BGP session:<a href="#section-9.2.2.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2.2.2-3.1">
                                1. Prefixes not allocated by IANA (IPv6 only) (<a href="#sec-iana-allocated-prefix-filters" class="auto internal xref">Section 6.2.1</a>)<a href="#section-9.2.2.2-3.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.2.2-3.2">
                                2. RPKI invalid prefixes (<a href="#sec-sidr-rov" class="auto internal xref">Section 7.2.1</a>)<a href="#section-9.2.2.2-3.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.2.2-3.3">
                                3. Prefixes with an invalid AS path (ASPA) (<a href="#sec-sidr-aspa" class="auto internal xref">Section 7.2.2</a>)<a href="#section-9.2.2.2-3.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.2.2-3.4">
                                4. Prefixes with an invalid AS path (longer than 64 entries) (<a href="#sec-as-path-filtering" class="auto internal xref">Section 8.3</a>)<a href="#section-9.2.2.2-3.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.2.2-3.5">
                                5. Prefixes with an invalid AS path (containing private or reserved AS numbers) (<a href="#sec-as-path-filtering" class="auto internal xref">Section 8.3</a>)<a href="#section-9.2.2.2-3.5" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.2.2-3.6">
                                6. Prefixes that are not globally routable (<a href="#sec-special-purpose-prefixes" class="auto internal xref">Section 6.1</a>)<a href="#section-9.2.2.2-3.6" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.2.2-3.7">
                                7. The default route (<a href="#sec-the-default-route" class="auto internal xref">Section 6.4</a>)<a href="#section-9.2.2.2-3.7" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.2.2-3.8">
                                8. Routes not intended for re-export (<a href="#sec-bgp-community-scrubbing" class="auto internal xref">Section 8.5</a>)<a href="#section-9.2.2.2-3.8" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.2.2-3.9">
                                9. Routes not listing the BGP speaker as the next-hop (<a href="#sec-next-hop-filtering" class="auto internal xref">Section 8.4</a>)<a href="#section-9.2.2.2-3.9" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.2.2-3.10">
                                10. Routes that are too specific or too unspecific (<a href="#sec-prefixes-that-are-too-specific" class="auto internal xref">Section 6.3</a>)<a href="#section-9.2.2.2-3.10" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-9.2.2.2-4">
                            In some cases, the customer may desire to receive the default route in addition to the full BGP table.
                            This can be done by the provider removing the filter for the default route in Rule 7.
                            As the default route may not be present in the routing table, operators <span class="bcp14">SHOULD</span> only originate it for neighbors that requested it.<a href="#section-9.2.2.2-4" class="pilcrow">¶</a></p>
<p id="section-9.2.2.2-5">
                            Note that Rule 9 is technically not necessary for eBGP.
                            However, in some rare cases misconfigurations or implementation errors may occur, especially on sessions with a neighbor via an IXP LAN (directly or indirectly), where the implementation on the BGP speaker might export routes with a non-local next-hop.
                            While Rule 9 could prevent disturbance in such cases, the likelihood of such events is sufficiently low that operators <span class="bcp14">MAY</span> opt to not use Rule 9.<a href="#section-9.2.2.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-filtering-with-upstream-providers">
<section id="section-9.2.3">
          <h4 id="name-filters-with-upstream-provi">
<a href="#section-9.2.3" class="section-number selfRef">9.2.3. </a><a href="#name-filters-with-upstream-provi" class="section-name selfRef">Filters with Upstream Providers</a>
          </h4>
<div id="sec-inbound-filtering-with-upstreams">
<section id="section-9.2.3.1">
            <h5 id="name-inbound-filtering-3">
<a href="#section-9.2.3.1" class="section-number selfRef">9.2.3.1. </a><a href="#name-inbound-filtering-3" class="section-name selfRef">Inbound Filtering</a>
            </h5>
<p id="section-9.2.3.1-1">
                            If the upstream provider is supposed to announce only the default route, a simple filter will be applied to accept only the default prefix and nothing else.<a href="#section-9.2.3.1-1" class="pilcrow">¶</a></p>
<p id="section-9.2.3.1-2">
                            If the full routing table is desired from the upstream, the prefix filtering below should be applied:<a href="#section-9.2.3.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2.3.1-3.1">
                                1. Prefixes not allocated by IANA (IPv6 only) (<a href="#sec-iana-allocated-prefix-filters" class="auto internal xref">Section 6.2.1</a>)<a href="#section-9.2.3.1-3.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.3.1-3.2">
                                2. RPKI invalid prefixes (<a href="#sec-sidr-rov" class="auto internal xref">Section 7.2.1</a>)<a href="#section-9.2.3.1-3.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.3.1-3.3">
                                3. Prefixes with an invalid AS path (ASPA) (<a href="#sec-sidr-aspa" class="auto internal xref">Section 7.2.2</a>)<a href="#section-9.2.3.1-3.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.3.1-3.4">
                                4. Prefixes with an invalid AS path (longer than 64 entries) (<a href="#sec-as-path-filtering" class="auto internal xref">Section 8.3</a>)<a href="#section-9.2.3.1-3.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.3.1-3.5">
                                5. Prefixes with an invalid AS path (containing private or reserved AS numbers) (<a href="#sec-as-path-filtering" class="auto internal xref">Section 8.3</a>)<a href="#section-9.2.3.1-3.5" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.3.1-3.6">
                                6. Prefixes belonging to the local AS (<a href="#sec-filtering-prefixes-belonging-to-the-local-as" class="auto internal xref">Section 7.3</a>)<a href="#section-9.2.3.1-3.6" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.3.1-3.7">
                                6.1. Optionally: Reprioritizing prefixes belonging to the local AS' cone instead of filtering them (<a href="#sec-filtering-inbound-prefixes-belonging-to-ds" class="auto internal xref">Section 7.4</a>)<a href="#section-9.2.3.1-3.7" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.3.1-3.8">
                                7. Prefixes that are not globally routable (<a href="#sec-special-purpose-prefixes" class="auto internal xref">Section 6.1</a>)<a href="#section-9.2.3.1-3.8" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.3.1-3.9">
                                8. IXP LAN prefixes of IXPs the local AS is connected to (<a href="#sec-ixp-lan-prefixes" class="auto internal xref">Section 7.6</a>)<a href="#section-9.2.3.1-3.9" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.3.1-3.10">
                                9. The default route (<a href="#sec-the-default-route" class="auto internal xref">Section 6.4</a>)<a href="#section-9.2.3.1-3.10" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.3.1-3.11">
                                10. Routes not matching the neighbor's next-hop (<a href="#sec-next-hop-filtering" class="auto internal xref">Section 8.4</a>)<a href="#section-9.2.3.1-3.11" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-9.2.3.1-3.12">
                                11. Routes that are too specific or too unspecific (<a href="#sec-prefixes-that-are-too-specific" class="auto internal xref">Section 6.3</a>)<a href="#section-9.2.3.1-3.12" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-9.2.3.1-4">
                            Sometimes, the default route (in addition to the full BGP table) can be desired from an upstream provider.
                            In that case, Rule 9 <span class="bcp14">MAY</span> be removed.<a href="#section-9.2.3.1-4" class="pilcrow">¶</a></p>
<p id="section-9.2.3.1-5">
                            Additionally, Rule 10 <span class="bcp14">MUST NOT</span> be set in the rare case of an IXP routeserver providing upstream (see <span>[<a href="#CommunityIX" class="cite xref">CommunityIX</a>]</span>), while it <span class="bcp14">SHOULD</span> be set when receiving upstream on a direct session via IXP LANs (see <a href="#sec-next-hop-filtering" class="auto internal xref">Section 8.4</a>).<a href="#section-9.2.3.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-outbound-filtering-with-upstreams">
<section id="section-9.2.3.2">
            <h5 id="name-outbound-filtering-3">
<a href="#section-9.2.3.2" class="section-number selfRef">9.2.3.2. </a><a href="#name-outbound-filtering-3" class="section-name selfRef">Outbound Filtering</a>
            </h5>
<p id="section-9.2.3.2-1">
                            In general, at least the same outbound filters as applied for Internet peers (<a href="#sec-outbound-filtering-with-peers" class="auto internal xref">Section 9.2.1.2</a>) <span class="bcp14">SHOULD</span> be applied for upstreams.
                            However, different policies could be applied if a particular upstream should not provide transit to all prefixes.<a href="#section-9.2.3.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2.3.2-2">
                            When deciding to selectively announce prefixes to an upstream, it is important to be mindful of potential issues with uRPF in case of asymmetric traffic flows.
                            In certain strict uRPF cases traffic for a prefix may be blackholed if the outbound route to a destination traverses one upstream, while the prefix is only announced to another upstream.
                            It is <span class="bcp14">RECOMMENDED</span> that operators do not implement strict uRPF solely based on visible or selected routes received from a peer.
                            Instead, either an approach similar to the cone determination (see <a href="#sec-rir-allocated-prefix-filters" class="auto internal xref">Section 7.1</a>), or loose uRPF should be used (see <span>[<a href="#RFC8704" class="cite xref">RFC8704</a>]</span>).<a href="#section-9.2.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-prefix-filtering-recommendations-for-leaf-networks">
<section id="section-9.3">
        <h3 id="name-prefix-filtering-recommendati">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-prefix-filtering-recommendati" class="section-name selfRef">Prefix Filtering Recommendations for Leaf Networks</a>
        </h3>
<div id="sec-inbound-filtering-leafs">
<section id="section-9.3.1">
          <h4 id="name-inbound-filtering-4">
<a href="#section-9.3.1" class="section-number selfRef">9.3.1. </a><a href="#name-inbound-filtering-4" class="section-name selfRef">Inbound Filtering</a>
          </h4>
<p id="section-9.3.1-1">
                        The leaf network will deploy the filters corresponding to the routes it is requesting from its upstream.
                        If a default route is requested, a simple inbound filter can be applied to accept only the default route (<a href="#sec-the-default-route" class="auto internal xref">Section 6.4</a>).
                        If the leaf network is not capable of listing the prefixes because there are too many (for example, if it requires the full Internet routing table), then it <span class="bcp14">SHOULD</span> follow the filter recommendations in <a href="#sec-inbound-filtering-with-upstreams" class="auto internal xref">Section 9.2.3.1</a>.<a href="#section-9.3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-outbound-filtering-leafs">
<section id="section-9.3.2">
          <h4 id="name-outbound-filtering-4">
<a href="#section-9.3.2" class="section-number selfRef">9.3.2. </a><a href="#name-outbound-filtering-4" class="section-name selfRef">Outbound Filtering</a>
          </h4>
<p id="section-9.3.2-1">
                        A leaf network will most likely have a very straightforward policy:
                        it <span class="bcp14">SHOULD</span> only announce its local routes.
                        For additional scrutiny, it is also <span class="bcp14">RECOMMENDED</span> that leaf ASes follow the recommendations in <a href="#sec-outbound-filtering-with-upstreams" class="auto internal xref">Section 9.2.3.2</a> to avoid announcing invalid routes to its upstream provider, and for additional resillience if the network later becomes multihomed.<a href="#section-9.3.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-prefix-filtering-mutual-transit">
<section id="section-9.4">
        <h3 id="name-prefix-filtering-recommendatio">
<a href="#section-9.4" class="section-number selfRef">9.4. </a><a href="#name-prefix-filtering-recommendatio" class="section-name selfRef">Prefix Filtering Recommendations for Mutual Transit</a>
        </h3>
<p id="section-9.4-1">
                    If a mutual-transit relationship as defined in <span>[<a href="#I-D.ietf-sidrops-aspa-verification" class="cite xref">I-D.ietf-sidrops-aspa-verification</a>]</span> exists between two neighbors, each neighbor <span class="bcp14">SHOULD</span> follow the recommendations in <span>[<a href="#I-D.ietf-sidrops-aspa-verification" class="cite xref">I-D.ietf-sidrops-aspa-verification</a>]</span>.
                    Furthermore, it is <span class="bcp14">RECOMMENDED</span> that both parties in a mutual-transit relationship take additional precautions to ensure that they do not export routes the other neighbor learned from their own upstreams to peers and upstreams of their own.
                    This can be accomplished, e.g., via annotations of imported routes (see <a href="#sec-filtering-outbound-prefixes-communities" class="auto internal xref">Section 7.5.2</a>) differing based on a filter representing the neighbor's cone (see <a href="#sec-rir-allocated-prefix-filters" class="auto internal xref">Section 7.1</a>).<a href="#section-9.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-prefix-filtering-recommendations-for-ibgp">
<section id="section-9.5">
        <h3 id="name-prefix-filtering-recommendation">
<a href="#section-9.5" class="section-number selfRef">9.5. </a><a href="#name-prefix-filtering-recommendation" class="section-name selfRef">Prefix Filtering Recommendations for iBGP</a>
        </h3>
<p id="section-9.5-1">
                    While iBGP sessions should generally be trusted, it is good practice to implement basic filters on iBGP sessions carrying external NLRI as well.
                    It is <span class="bcp14">RECOMMENDED</span> that other internal routing signalling is handled by a dedicated IGP or via a dedicated VRF/Routing Domain (see <span>[<a href="#NSRC-17" class="cite xref">NSRC-17</a>]</span>) to reduce the likelihood of internal routes leaking due to misconfigurations, with routes appropriately annotated to not be exported (see <a href="#sec-filtering-outbound-prefixes" class="auto internal xref">Section 7.5</a>).
                    Doing so ensures that, e.g., localized misconfigurations, e.g., leaked (internal) routes, remain localized to a region or PoP, instead of spreading throughout the whole AS and to external neighbors, ideally limiting their impact.<a href="#section-9.5-1" class="pilcrow">¶</a></p>
<p id="section-9.5-2">
                    If the iBGP mesh/sessions via a route reflector (see <span>[<a href="#RFC4456" class="cite xref">RFC4456</a>]</span>) of BGP speakers connected to external neighbors only carries external NLRI, the following filters are <span class="bcp14">RECOMMENDED</span>, the following rules should be applied when importing or exporting routes.<a href="#section-9.5-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.5-3.1">
                        1. Prefixes not announced by the local AS not carrying an annotation (either via the OTC attribute evaluated according to <span>[<a href="#RFC9234" class="cite xref">RFC9234</a>]</span>, or a large community as outlined in <a href="#sec-filtering-outbound-prefixes" class="auto internal xref">Section 7.5</a>)<a href="#section-9.5-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-9.5-3.2">
                        2. Prefixes not allocated by IANA (IPv6 only) (<a href="#sec-iana-allocated-prefix-filters" class="auto internal xref">Section 6.2.1</a>)<a href="#section-9.5-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-9.5-3.3">
                        3. RPKI invalid prefixes (<a href="#sec-sidr-rov" class="auto internal xref">Section 7.2.1</a>)<a href="#section-9.5-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-9.5-3.4">
                        4. Prefixes with an invalid AS path (ASPA) (<a href="#sec-sidr-aspa" class="auto internal xref">Section 7.2.2</a>)<a href="#section-9.5-3.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-9.5-3.5">
                        5. Prefixes with an invalid AS path (longer than 64 entries) (<a href="#sec-as-path-filtering" class="auto internal xref">Section 8.3</a>)<a href="#section-9.5-3.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-9.5-3.6">
                        6. Prefixes with an invalid AS path (containing private or reserved AS numbers) (<a href="#sec-as-path-filtering" class="auto internal xref">Section 8.3</a>)<a href="#section-9.5-3.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-9.5-3.7">
                        7. Prefixes that are not globally routable (<a href="#sec-special-purpose-prefixes" class="auto internal xref">Section 6.1</a>)<a href="#section-9.5-3.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-9.5-3.8">
                        9. The default route (<a href="#sec-the-default-route" class="auto internal xref">Section 6.4</a>)<a href="#section-9.5-3.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-9.5-3.9">
                        11. Routes that are too specific or too unspecific (<a href="#sec-prefixes-that-are-too-specific" class="auto internal xref">Section 6.3</a>)<a href="#section-9.5-3.9" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-9.5-4">
                    Depending on the local circumstances an operator <span class="bcp14">MAY</span> deviate from this suggestion and refrain from using individual rules.
                    For example, if the AS ingests a default route from at least one neighbor, Rule 9 should be omitted.
                    Similarly, when allowing downstreams to announce hyperspecifics (see <a href="#sec-filtering-outbound-prefixes-communities" class="auto internal xref">Section 7.5.2</a>), Rule 10 <span class="bcp14">SHOULD</span> be omitted.<a href="#section-9.5-4" class="pilcrow">¶</a></p>
<p id="section-9.5-5">
                    While an operator <span class="bcp14">MAY</span> opt to not use any of the suggested rules, it is <span class="bcp14">RECOMMENDED</span> that at least Rule 1 is applied to iBGP sessions to ensure absent annotations do not propagate and cause route leaks.<a href="#section-9.5-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-iana-considerations">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-10-1">
                This document does not require any IANA actions.<a href="#section-10-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-security-considerations">
<section id="section-11">
      <h2 id="name-security-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-11-1">
                This document is entirely about BGP operational security.
                The document understands security not only as resilience against attacks, but also in the context of safety, i.e., ensuring that systems remain operational and behave as expected even if individual components fail or are mishandled.
                It depicts best practices that one should adopt to secure BGP infrastructure: protecting BGP routers and BGP sessions, adopting consistent BGP prefix and AS path filters, and configuring other options to secure the BGP network.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">
                This document does not aim to describe specific BGP implementations, their potential vulnerabilities, or ways they handle errors.
                It does not detail how protection could be enforced against attack techniques using crafted packets.<a href="#section-11-2" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-12">
      <h2 id="name-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-12.1">
        <h3 id="name-normative-references">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4271">[RFC4271]</dt>
        <dd>
<span class="refAuthor">Rekhter, Y., Ed.</span>, <span class="refAuthor">Li, T., Ed.</span>, and <span class="refAuthor">S. Hares, Ed.</span>, <span class="refTitle">"A Border Gateway Protocol 4 (BGP-4)"</span>, <span class="seriesInfo">RFC 4271</span>, <span class="seriesInfo">DOI 10.17487/RFC4271</span>, <time datetime="2006-01" class="refDate">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4271">https://www.rfc-editor.org/info/rfc4271</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5082">[RFC5082]</dt>
        <dd>
<span class="refAuthor">Gill, V.</span>, <span class="refAuthor">Heasley, J.</span>, <span class="refAuthor">Meyer, D.</span>, <span class="refAuthor">Savola, P., Ed.</span>, and <span class="refAuthor">C. Pignataro</span>, <span class="refTitle">"The Generalized TTL Security Mechanism (GTSM)"</span>, <span class="seriesInfo">RFC 5082</span>, <span class="seriesInfo">DOI 10.17487/RFC5082</span>, <time datetime="2007-10" class="refDate">October 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5082">https://www.rfc-editor.org/info/rfc5082</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5925">[RFC5925]</dt>
        <dd>
<span class="refAuthor">Touch, J.</span>, <span class="refAuthor">Mankin, A.</span>, and <span class="refAuthor">R. Bonica</span>, <span class="refTitle">"The TCP Authentication Option"</span>, <span class="seriesInfo">RFC 5925</span>, <span class="seriesInfo">DOI 10.17487/RFC5925</span>, <time datetime="2010-06" class="refDate">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5925">https://www.rfc-editor.org/info/rfc5925</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6811">[RFC6811]</dt>
        <dd>
<span class="refAuthor">Mohapatra, P.</span>, <span class="refAuthor">Scudder, J.</span>, <span class="refAuthor">Ward, D.</span>, <span class="refAuthor">Bush, R.</span>, and <span class="refAuthor">R. Austein</span>, <span class="refTitle">"BGP Prefix Origin Validation"</span>, <span class="seriesInfo">RFC 6811</span>, <span class="seriesInfo">DOI 10.17487/RFC6811</span>, <time datetime="2013-01" class="refDate">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6811">https://www.rfc-editor.org/info/rfc6811</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7115">[RFC7115]</dt>
        <dd>
<span class="refAuthor">Bush, R.</span>, <span class="refTitle">"Origin Validation Operation Based on the Resource Public Key Infrastructure (RPKI)"</span>, <span class="seriesInfo">BCP 185</span>, <span class="seriesInfo">RFC 7115</span>, <span class="seriesInfo">DOI 10.17487/RFC7115</span>, <time datetime="2014-01" class="refDate">January 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7115">https://www.rfc-editor.org/info/rfc7115</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7196">[RFC7196]</dt>
        <dd>
<span class="refAuthor">Pelsser, C.</span>, <span class="refAuthor">Bush, R.</span>, <span class="refAuthor">Patel, K.</span>, <span class="refAuthor">Mohapatra, P.</span>, and <span class="refAuthor">O. Maennel</span>, <span class="refTitle">"Making Route Flap Damping Usable"</span>, <span class="seriesInfo">RFC 7196</span>, <span class="seriesInfo">DOI 10.17487/RFC7196</span>, <time datetime="2014-05" class="refDate">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7196">https://www.rfc-editor.org/info/rfc7196</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8092">[RFC8092]</dt>
        <dd>
<span class="refAuthor">Heitz, J., Ed.</span>, <span class="refAuthor">Snijders, J., Ed.</span>, <span class="refAuthor">Patel, K.</span>, <span class="refAuthor">Bagdonas, I.</span>, and <span class="refAuthor">N. Hilliard</span>, <span class="refTitle">"BGP Large Communities Attribute"</span>, <span class="seriesInfo">RFC 8092</span>, <span class="seriesInfo">DOI 10.17487/RFC8092</span>, <time datetime="2017-02" class="refDate">February 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8092">https://www.rfc-editor.org/info/rfc8092</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8201">[RFC8201]</dt>
        <dd>
<span class="refAuthor">McCann, J.</span>, <span class="refAuthor">Deering, S.</span>, <span class="refAuthor">Mogul, J.</span>, and <span class="refAuthor">R. Hinden, Ed.</span>, <span class="refTitle">"Path MTU Discovery for IP version 6"</span>, <span class="seriesInfo">STD 87</span>, <span class="seriesInfo">RFC 8201</span>, <span class="seriesInfo">DOI 10.17487/RFC8201</span>, <time datetime="2017-07" class="refDate">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8201">https://www.rfc-editor.org/info/rfc8201</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8704">[RFC8704]</dt>
        <dd>
<span class="refAuthor">Sriram, K.</span>, <span class="refAuthor">Montgomery, D.</span>, and <span class="refAuthor">J. Haas</span>, <span class="refTitle">"Enhanced Feasible-Path Unicast Reverse Path Forwarding"</span>, <span class="seriesInfo">BCP 84</span>, <span class="seriesInfo">RFC 8704</span>, <span class="seriesInfo">DOI 10.17487/RFC8704</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8704">https://www.rfc-editor.org/info/rfc8704</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9234">[RFC9234]</dt>
        <dd>
<span class="refAuthor">Azimov, A.</span>, <span class="refAuthor">Bogomazov, E.</span>, <span class="refAuthor">Bush, R.</span>, <span class="refAuthor">Patel, K.</span>, and <span class="refAuthor">K. Sriram</span>, <span class="refTitle">"Route Leak Prevention and Detection Using Roles in UPDATE and OPEN Messages"</span>, <span class="seriesInfo">RFC 9234</span>, <span class="seriesInfo">DOI 10.17487/RFC9234</span>, <time datetime="2022-05" class="refDate">May 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9234">https://www.rfc-editor.org/info/rfc9234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9319">[RFC9319]</dt>
        <dd>
<span class="refAuthor">Gilad, Y.</span>, <span class="refAuthor">Goldberg, S.</span>, <span class="refAuthor">Sriram, K.</span>, <span class="refAuthor">Snijders, J.</span>, and <span class="refAuthor">B. Maddison</span>, <span class="refTitle">"The Use of maxLength in the Resource Public Key Infrastructure (RPKI)"</span>, <span class="seriesInfo">BCP 185</span>, <span class="seriesInfo">RFC 9319</span>, <span class="seriesInfo">DOI 10.17487/RFC9319</span>, <time datetime="2022-10" class="refDate">October 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9319">https://www.rfc-editor.org/info/rfc9319</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-sidrops-aspa-verification">[I-D.ietf-sidrops-aspa-verification]</dt>
      <dd>
<span class="refAuthor">Azimov, A.</span>, <span class="refAuthor">Bogomazov, E.</span>, <span class="refAuthor">Bush, R.</span>, <span class="refAuthor">Patel, K.</span>, <span class="refAuthor">Snijders, J.</span>, and <span class="refAuthor">K. Sriram</span>, <span class="refTitle">"BGP AS_PATH Verification Based on Autonomous System Provider Authorization (ASPA) Objects"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-sidrops-aspa-verification-16</span>, <time datetime="2023-08-29" class="refDate">29 August 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-sidrops-aspa-verification-16">https://datatracker.ietf.org/doc/html/draft-ietf-sidrops-aspa-verification-16</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-12.2">
        <h3 id="name-informative-references">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC1191">[RFC1191]</dt>
        <dd>
<span class="refAuthor">Mogul, J.</span> and <span class="refAuthor">S. Deering</span>, <span class="refTitle">"Path MTU discovery"</span>, <span class="seriesInfo">RFC 1191</span>, <span class="seriesInfo">DOI 10.17487/RFC1191</span>, <time datetime="1990-11" class="refDate">November 1990</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1191">https://www.rfc-editor.org/info/rfc1191</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1918">[RFC1918]</dt>
        <dd>
<span class="refAuthor">Rekhter, Y.</span>, <span class="refAuthor">Moskowitz, B.</span>, <span class="refAuthor">Karrenberg, D.</span>, <span class="refAuthor">de Groot, G. J.</span>, and <span class="refAuthor">E. Lear</span>, <span class="refTitle">"Address Allocation for Private Internets"</span>, <span class="seriesInfo">BCP 5</span>, <span class="seriesInfo">RFC 1918</span>, <span class="seriesInfo">DOI 10.17487/RFC1918</span>, <time datetime="1996-02" class="refDate">February 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1918">https://www.rfc-editor.org/info/rfc1918</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1997">[RFC1997]</dt>
        <dd>
<span class="refAuthor">Chandra, R.</span>, <span class="refAuthor">Traina, P.</span>, and <span class="refAuthor">T. Li</span>, <span class="refTitle">"BGP Communities Attribute"</span>, <span class="seriesInfo">RFC 1997</span>, <span class="seriesInfo">DOI 10.17487/RFC1997</span>, <time datetime="1996-08" class="refDate">August 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1997">https://www.rfc-editor.org/info/rfc1997</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2827">[RFC2827]</dt>
        <dd>
<span class="refAuthor">Ferguson, P.</span> and <span class="refAuthor">D. Senie</span>, <span class="refTitle">"Network Ingress Filtering: Defeating Denial of Service Attacks which employ IP Source Address Spoofing"</span>, <span class="seriesInfo">BCP 38</span>, <span class="seriesInfo">RFC 2827</span>, <span class="seriesInfo">DOI 10.17487/RFC2827</span>, <time datetime="2000-05" class="refDate">May 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2827">https://www.rfc-editor.org/info/rfc2827</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3704">[RFC3704]</dt>
        <dd>
<span class="refAuthor">Baker, F.</span> and <span class="refAuthor">P. Savola</span>, <span class="refTitle">"Ingress Filtering for Multihomed Networks"</span>, <span class="seriesInfo">BCP 84</span>, <span class="seriesInfo">RFC 3704</span>, <span class="seriesInfo">DOI 10.17487/RFC3704</span>, <time datetime="2004-03" class="refDate">March 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3704">https://www.rfc-editor.org/info/rfc3704</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4012">[RFC4012]</dt>
        <dd>
<span class="refAuthor">Blunk, L.</span>, <span class="refAuthor">Damas, J.</span>, <span class="refAuthor">Parent, F.</span>, and <span class="refAuthor">A. Robachevsky</span>, <span class="refTitle">"Routing Policy Specification Language next generation (RPSLng)"</span>, <span class="seriesInfo">RFC 4012</span>, <span class="seriesInfo">DOI 10.17487/RFC4012</span>, <time datetime="2005-03" class="refDate">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4012">https://www.rfc-editor.org/info/rfc4012</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4456">[RFC4456]</dt>
        <dd>
<span class="refAuthor">Bates, T.</span>, <span class="refAuthor">Chen, E.</span>, and <span class="refAuthor">R. Chandra</span>, <span class="refTitle">"BGP Route Reflection: An Alternative to Full Mesh Internal BGP (IBGP)"</span>, <span class="seriesInfo">RFC 4456</span>, <span class="seriesInfo">DOI 10.17487/RFC4456</span>, <time datetime="2006-04" class="refDate">April 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4456">https://www.rfc-editor.org/info/rfc4456</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6192">[RFC6192]</dt>
        <dd>
<span class="refAuthor">Dugal, D.</span>, <span class="refAuthor">Pignataro, C.</span>, and <span class="refAuthor">R. Dunn</span>, <span class="refTitle">"Protecting the Router Control Plane"</span>, <span class="seriesInfo">RFC 6192</span>, <span class="seriesInfo">DOI 10.17487/RFC6192</span>, <time datetime="2011-03" class="refDate">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6192">https://www.rfc-editor.org/info/rfc6192</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6480">[RFC6480]</dt>
        <dd>
<span class="refAuthor">Lepinski, M.</span> and <span class="refAuthor">S. Kent</span>, <span class="refTitle">"An Infrastructure to Support Secure Internet Routing"</span>, <span class="seriesInfo">RFC 6480</span>, <span class="seriesInfo">DOI 10.17487/RFC6480</span>, <time datetime="2012-02" class="refDate">February 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6480">https://www.rfc-editor.org/info/rfc6480</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6666">[RFC6666]</dt>
        <dd>
<span class="refAuthor">Hilliard, N.</span> and <span class="refAuthor">D. Freedman</span>, <span class="refTitle">"A Discard Prefix for IPv6"</span>, <span class="seriesInfo">RFC 6666</span>, <span class="seriesInfo">DOI 10.17487/RFC6666</span>, <time datetime="2012-08" class="refDate">August 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6666">https://www.rfc-editor.org/info/rfc6666</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6952">[RFC6952]</dt>
        <dd>
<span class="refAuthor">Jethanandani, M.</span>, <span class="refAuthor">Patel, K.</span>, and <span class="refAuthor">L. Zheng</span>, <span class="refTitle">"Analysis of BGP, LDP, PCEP, and MSDP Issues According to the Keying and Authentication for Routing Protocols (KARP) Design Guide"</span>, <span class="seriesInfo">RFC 6952</span>, <span class="seriesInfo">DOI 10.17487/RFC6952</span>, <time datetime="2013-05" class="refDate">May 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6952">https://www.rfc-editor.org/info/rfc6952</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7132">[RFC7132]</dt>
        <dd>
<span class="refAuthor">Kent, S.</span> and <span class="refAuthor">A. Chi</span>, <span class="refTitle">"Threat Model for BGP Path Security"</span>, <span class="seriesInfo">RFC 7132</span>, <span class="seriesInfo">DOI 10.17487/RFC7132</span>, <time datetime="2014-02" class="refDate">February 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7132">https://www.rfc-editor.org/info/rfc7132</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7454">[RFC7454]</dt>
        <dd>
<span class="refAuthor">Durand, J.</span>, <span class="refAuthor">Pepelnjak, I.</span>, and <span class="refAuthor">G. Doering</span>, <span class="refTitle">"BGP Operations and Security"</span>, <span class="seriesInfo">BCP 194</span>, <span class="seriesInfo">RFC 7454</span>, <span class="seriesInfo">DOI 10.17487/RFC7454</span>, <time datetime="2015-02" class="refDate">February 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7454">https://www.rfc-editor.org/info/rfc7454</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7947">[RFC7947]</dt>
        <dd>
<span class="refAuthor">Jasinska, E.</span>, <span class="refAuthor">Hilliard, N.</span>, <span class="refAuthor">Raszuk, R.</span>, and <span class="refAuthor">N. Bakker</span>, <span class="refTitle">"Internet Exchange BGP Route Server"</span>, <span class="seriesInfo">RFC 7947</span>, <span class="seriesInfo">DOI 10.17487/RFC7947</span>, <time datetime="2016-09" class="refDate">September 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7947">https://www.rfc-editor.org/info/rfc7947</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8195">[RFC8195]</dt>
        <dd>
<span class="refAuthor">Snijders, J.</span>, <span class="refAuthor">Heasley, J.</span>, and <span class="refAuthor">M. Schmidt</span>, <span class="refTitle">"Use of BGP Large Communities"</span>, <span class="seriesInfo">RFC 8195</span>, <span class="seriesInfo">DOI 10.17487/RFC8195</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8195">https://www.rfc-editor.org/info/rfc8195</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9229">[RFC9229]</dt>
        <dd>
<span class="refAuthor">Chroboczek, J.</span>, <span class="refTitle">"IPv4 Routes with an IPv6 Next Hop in the Babel Routing Protocol"</span>, <span class="seriesInfo">RFC 9229</span>, <span class="seriesInfo">DOI 10.17487/RFC9229</span>, <time datetime="2022-05" class="refDate">May 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9229">https://www.rfc-editor.org/info/rfc9229</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TBD">[TBD]</dt>
        <dd>
<span class="refAuthor">Holder, P.</span>, <span class="refTitle">"Reference still to be added"</span>, <time datetime="2023-11" class="refDate">November 2023</time>, <span>&lt;<a href="https://example.com">https://example.com</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NSRC-17">[NSRC-17]</dt>
        <dd>
<span class="refAuthor">Smith, P.</span>, <span class="refTitle">"BGP Best Current Practices"</span>, <time datetime="2017-02" class="refDate">February 2017</time>, <span>&lt;<a href="https://nsrc.org/workshops/2017/apricot2017/bgp/bgp/preso/05-BGP-BCP.pdf">https://nsrc.org/workshops/2017/apricot2017/bgp/bgp/preso/05-BGP-BCP.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="KIRIN-22">[KIRIN-22]</dt>
        <dd>
<span class="refAuthor">Prehn, L.</span>, <span class="refAuthor">Foremski, P.</span>, and <span class="refAuthor">O. Gasser</span>, <span class="refTitle">"Kirin: Hitting the Internet with Millions of Distributed IPv6 Announcements"</span>, <time datetime="2022-10" class="refDate">October 2022</time>, <span>&lt;<a href="https://arxiv.org/abs/2210.10676">https://arxiv.org/abs/2210.10676</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="APNICTRN-17">[APNICTRN-17]</dt>
        <dd>
<span class="refAuthor">Roman, N.</span> and <span class="refAuthor">A. Bhatia</span>, <span class="refTitle">"BGP Routing and IXP Workshop"</span>, <time datetime="2017-03" class="refDate">March 2017</time>, <span>&lt;<a href="https://wiki.apnictraining.net/_media/ixpworkshop-kolisoc-in/2.routing_ixp_workshop_upd.pdf">https://wiki.apnictraining.net/_media/ixpworkshop-kolisoc-in/2.routing_ixp_workshop_upd.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RIPE-804">[RIPE-804]</dt>
        <dd>
<span class="refAuthor">RIPE</span>, <span class="refTitle">"IPv4 Address Allocation and Assignment Policies for the RIPE NCC Service Region"</span>, <span class="seriesInfo">RIPE 804</span>, <time datetime="2023-09" class="refDate">September 2023</time>, <span>&lt;<a href="https://www.ripe.net/publications/docs/ripe-804">https://www.ripe.net/publications/docs/ripe-804</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CCR-22">[CCR-22]</dt>
        <dd>
<span class="refAuthor">Sediqi, Z.</span>, <span class="refAuthor">Prehn, L.</span>, and <span class="refAuthor">O. Gasser</span>, <span class="refTitle">"Hyper-specific prefixes: gotta enjoy the little things in interdomain routing"</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://dl.acm.org/doi/abs/10.1145/3544912.3544916">https://dl.acm.org/doi/abs/10.1145/3544912.3544916</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NLNOG-22">[NLNOG-22]</dt>
        <dd>
<span class="refAuthor">Li, Q.</span>, <span class="refTitle">"Voorkom AS-set namespace collisions. AS-A2B vs AS51088:AS-A2B"</span>, <span class="seriesInfo">NLNOG Mailinglist 2022</span>, <time datetime="2022-11" class="refDate">November 2022</time>, <span>&lt;<a href="http://mailman.nlnog.net/pipermail/nlnog/2022-November/003046.html">http://mailman.nlnog.net/pipermail/nlnog/2022-November/003046.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FENG-22">[FENG-22]</dt>
        <dd>
<span class="refAuthor">Feng, X.</span>, <span class="refAuthor">Li, Q.</span>, <span class="refAuthor">Sun, K.</span>, <span class="refAuthor">Xu, K.</span>, <span class="refAuthor">Liu, B.</span>, <span class="refAuthor">Zheng, X.</span>, <span class="refAuthor">Yang, Q.</span>, <span class="refAuthor">Duan, H.</span>, and <span class="refAuthor">Z. Qian</span>, <span class="refTitle">"PMTUD is not Panacea: Revisiting IP Fragmentation Attacks against TCP"</span>, <span class="seriesInfo">NDSS 2022</span>, <time datetime="2022-02" class="refDate">February 2022</time>, <span>&lt;<a href="https://csis.gmu.edu/ksun/publications/TCP%20Fragmentation_NDSS22.pdf">https://csis.gmu.edu/ksun/publications/TCP%20Fragmentation_NDSS22.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RIPE-351">[RIPE-351]</dt>
        <dd>
<span class="refAuthor">Daniel, D.</span>, <span class="refTitle">"De-Bogonising New Address Blocks"</span>, <span class="seriesInfo">RIPE 351</span>, <time datetime="2005-10" class="refDate">October 2005</time>, <span>&lt;<a href="https://www.ripe.net/publications/docs/ripe-351">https://www.ripe.net/publications/docs/ripe-351</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RIPE-378">[RIPE-378]</dt>
        <dd>
<span class="refAuthor">Smith, P.</span> and <span class="refAuthor">C. Panigl</span>, <span class="refTitle">"RIPE Routing Working Group Recommendations On Route-flap Damping"</span>, <span class="seriesInfo">RIPE 378</span>, <time datetime="2006-05" class="refDate">May 2006</time>, <span>&lt;<a href="https://www.ripe.net/publications/docs/ripe-378">https://www.ripe.net/publications/docs/ripe-378</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RIPE-399">[RIPE-399]</dt>
        <dd>
<span class="refAuthor">Smith, P.</span>, <span class="refAuthor">Evans, R.</span>, and <span class="refAuthor">M. Hughes</span>, <span class="refTitle">"RIPE Routing Working Group Recommendations on Route Aggregation"</span>, <span class="seriesInfo">RIPE 399</span>, <time datetime="2006-12" class="refDate">December 2006</time>, <span>&lt;<a href="https://www.ripe.net/publications/docs/ripe-399">https://www.ripe.net/publications/docs/ripe-399</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RIPE-532">[RIPE-532]</dt>
        <dd>
<span class="refAuthor">Evans, R.</span> and <span class="refAuthor">P. Smith</span>, <span class="refTitle">"RIPE Routing Working Group Recommendations on IPv6 Route Aggregation"</span>, <span class="seriesInfo">RIPE 532</span>, <time datetime="2011-11" class="refDate">November 2011</time>, <span>&lt;<a href="https://www.ripe.net/publications/docs/ripe-532">https://www.ripe.net/publications/docs/ripe-532</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RIPE-580">[RIPE-580]</dt>
        <dd>
<span class="refAuthor">Bush, R.</span>, <span class="refAuthor">Pelsser, C.</span>, <span class="refAuthor">Kuhne, M.</span>, <span class="refAuthor">Maennel, O.</span>, <span class="refAuthor">Mohapatra, P.</span>, <span class="refAuthor">Patel, K.</span>, and <span class="refAuthor">R. Evans</span>, <span class="refTitle">"RIPE Routing Working Group Recommendations on Route Flap Damping"</span>, <span class="seriesInfo">RIPE 580</span>, <time datetime="2013-01" class="refDate">January 2013</time>, <span>&lt;<a href="https://www.ripe.net/publications/docs/ripe-580">https://www.ripe.net/publications/docs/ripe-580</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANAv4Spec">[IANAv4Spec]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"IANA IPv4 Special-Purpose Address Registry"</span>, <span>&lt;<a href="https://www.iana.org/assignments/iana-ipv4-special-registry">https://www.iana.org/assignments/iana-ipv4-special-registry</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANAv6Spec">[IANAv6Spec]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"IANA IPv6 Special-Purpose Address Registry"</span>, <span>&lt;<a href="https://www.iana.org/assignments/iana-ipv6-special-registry">https://www.iana.org/assignments/iana-ipv6-special-registry</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANAv4Reg">[IANAv4Reg]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"IANA IPv4 Address Space Registry"</span>, <span>&lt;<a href="https://www.iana.org/assignments/ipv4-address-space">https://www.iana.org/assignments/ipv4-address-space</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANAv6Reg">[IANAv6Reg]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Internet Protocol Version 6 Address Space"</span>, <span>&lt;<a href="https://www.iana.org/assignments/ipv6-address-space">https://www.iana.org/assignments/ipv6-address-space</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RADb">[RADb]</dt>
        <dd>
<span class="refAuthor">Merit Network Inc.</span>, <span class="refTitle">"RADb - The Internet Routing Registry"</span>, <span>&lt;<a href="https://www.radb.net">https://www.radb.net</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7705">[RFC7705]</dt>
        <dd>
<span class="refAuthor">George, W.</span> and <span class="refAuthor">S. Amante</span>, <span class="refTitle">"Autonomous System Migration Mechanisms and Their Effects on the BGP AS_PATH Attribute"</span>, <span class="seriesInfo">RFC 7705</span>, <span class="seriesInfo">DOI 10.17487/RFC7705</span>, <time datetime="2015-11" class="refDate">November 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7705">https://www.rfc-editor.org/info/rfc7705</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7353">[RFC7353]</dt>
        <dd>
<span class="refAuthor">Bellovin, S.</span>, <span class="refAuthor">Bush, R.</span>, and <span class="refAuthor">D. Ward</span>, <span class="refTitle">"Security Requirements for BGP Path Validation"</span>, <span class="seriesInfo">RFC 7353</span>, <span class="seriesInfo">DOI 10.17487/RFC7353</span>, <time datetime="2014-08" class="refDate">August 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7353">https://www.rfc-editor.org/info/rfc7353</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PeeringDB">[PeeringDB]</dt>
        <dd>
<span class="refAuthor">PeeringDB</span>, <span class="refTitle">"PeeringDB: The Interconnection Database"</span>, <span>&lt;<a href="https://www.peeringdb.com/">https://www.peeringdb.com/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CommunityIX">[CommunityIX]</dt>
        <dd>
<span class="refAuthor">IN-Berlin e.V.</span>, <span class="refTitle">"Community-IX by IN-Berlin e.V., the connectivity-platform for non-commercial projects, ideas and organisations in Berlin and Frankfurt"</span>, <span>&lt;<a href="https://www.community-ix.net/">https://www.community-ix.net/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="rpki-client">[rpki-client]</dt>
        <dd>
<span class="refAuthor">OpenBSD Project</span>, <span class="refTitle">"rpki-client 8.6 has been released"</span>, <span>&lt;<a href="https://marc.info/?l=openbsd-announce&amp;m=169645206105360">https://marc.info/?l=openbsd-announce&amp;m=169645206105360</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenBGPd">[OpenBGPd]</dt>
        <dd>
<span class="refAuthor">OpenBSD Project</span>, <span class="refTitle">"OpenBGPD 8.2 released"</span>, <span>&lt;<a href="https://marc.info/?l=openbsd-announce&amp;m=169624217322602">https://marc.info/?l=openbsd-announce&amp;m=169624217322602</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="bgpq4">[bgpq4]</dt>
        <dd>
<span class="refAuthor">Snijders, J.</span>, <span class="refTitle">"bgpq4 Git Repository"</span>, <span>&lt;<a href="https://github.com/bgp/bgpq4">https://github.com/bgp/bgpq4</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="hotRPKI">[hotRPKI]</dt>
      <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Heilman, E.</span>, <span class="refAuthor">Brogle, K.</span>, <span class="refAuthor">Reyzin, L.</span>, and <span class="refAuthor">S. Goldberg</span>, <span class="refTitle">""</span>, <span class="seriesInfo">DOI 10.1145/2535771.2535787</span>, <time datetime="2013-11" class="refDate">November 2013</time>, <span>&lt;<a href="https://dl.acm.org/doi/pdf/10.1145/2535771.2535787">https://dl.acm.org/doi/pdf/10.1145/2535771.2535787</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="acknowledgements">
<section id="appendix-A">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-A-1">
                This document is based on <span>[<a href="#RFC7454" class="cite xref">RFC7454</a>]</span> and we thank the original authors for their work.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tobias Fiebig</span></div>
<div dir="auto" class="left"><span class="org">Max-Planck-Institut fuer Informatik</span></div>
<div dir="auto" class="left"><span class="street-address">Campus E14</span></div>
<div dir="auto" class="left">
<span class="postal-code">66123</span> <span class="locality">Saarbruecken</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+49%20681%209325%203527" class="tel">+49 681 9325 3527</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:tfiebig@mpi-inf.mpg.de" class="email">tfiebig@mpi-inf.mpg.de</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
